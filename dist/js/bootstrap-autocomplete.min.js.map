{"version":3,"sources":["js/bootstrap-autocomplete.js"],"names":["$","DEF_OPTS","cls","placeHolder","searchMode","ignoreCase","fitWdith","dropUp","filtSame","badgeCls","dblclick4Edit","inputSearchDelay","forceSelect","minChar","multiple","KEY_CODES","TPLS","CLS","getCssNum","el","css","Number","replace","ohtml","e","append","html","setCaretPosition","oField","document","selection","createRange","moveStart","value","length","selectionStart","stopEvent","preventDefault","stopPropagation","isString","val","PlaceHolder","ac","placeholderEl","this","prependTo","text","params","refresh","selectedItems","hide","show","Badge","badge","resize","closeEl","find","badgeMarginL","badgeMarginR","maxWidth","padL","padR","innerWidth","input","emptyWidth","outerWidth","children","each","closeBadge","badgeEl","click","getLastBadge","badges","size","getCloestBadge","mouseX","mouseY","cloestBadgeEl","isLineMatched","pos","position","left","top","bottom","outerHeight","add","speicalData","item","panel","getSelectedItem","editingItem","ei","eiCode","c","code","eiName","n","name","valCode","valName","findItem","searchInData","itemName","badgeRender","call","itemUseHtml","attr","addClass","isReadonly","remove","removeSelected","blur","close","placeholder","after","isInSearchMode","getText4BadgeEdit","updateTextValue","doAdd","findSelectedItem","isSingleMode","before","addSelected","Input","inputCt","appendTo","inputSizer","inputEl","on","focus","isFocused","updateSizer","openOnFocus","getValue","fireOnFocus","removeClass","beforeMoveVal","confirmValue","fireOnBlur","keydown","specialKey","keyCode","itemCode","hasVal","caretPos","oSel","getCaretPosition","textLen","moveToLR","moveSelect","prevBadge","prev","nextBadge","next","relocate","setTimeout","empty","loadData","then","open","render","keyup","isLeft","moveToBadge","lastBadge","isEsc","fromBlur","added","clear","fireBlur","getSearchText","DropdownPanel","panelEl","isUp","moveToItem","selItem","items","scrollToSelected","selectedItem","scrollTop","height","data","searchText","matched","i","itemEl","itemRender","mousedown","width","inputPosLeft","destroy","removeData","AutoComplete","originEl","def","initialized","readonly","htmlOverHandler","resized4htmlOver","is","off","htmlClickHandler","hasClass","target","autocomplete","parents","htmlResizeHandler","elOverHandler","resized4elOver","addValue","opts","extend","onSuccess","noop","oldSelectedItems","clearValue","Array","formatedItems","push","loadDataItems","tmpData","fireInit","fireOnInit","fireOnChange","lastSearchData","needCheckRemote","toCheckCount","checkedItemCount","slice","always","setValue","mode","indexOf","mouseover","window","oldItems","newItems","trigger","fireOnSelect","fireOnDeSelect","clearData","splice","fire","setReadonly","findIndex","isItemMatched","regex","RegExp","str","escapeRegex","undefined","test","result","selCode","selName","isFromStr","dataItem","dataCode","dataName","defered","Deferred","loadedItems","resolve","reject","promise","specialData","insertAfter","offsetX","offsetY","fn","bsAutoComplete","args","arguments","$this","split","splitChar","apply","prototype","jQuery"],"mappings":"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","file":"bootstrap-autocomplete.min.js","sourcesContent":["(function ($) {\n  'use strict';\n\n  // DEF_OPTS\n  var DEF_OPTS = {\n    cls: '',\n    placeHolder: '请选择',\n    searchMode: 'code name',\n    ignoreCase: true,\n    fitWdith: true,\n    dropUp: false,\n    filtSame: false,\n    badgeCls: '',\n    dblclick4Edit: false,\n    inputSearchDelay: 200,\n    forceSelect: false,\n    minChar: 1,\n    multiple: true\n  };\n\n  // KEY_CODES\n  var KEY_CODES = {\n    ENTER: 13, TAB: 9, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40, ESC: 27, BACK: 8, DELETE: 46\n  };\n\n  // TPLS\n  var TPLS = {\n    containerTpl: '<div class=\"btn-group bootstrap-autocomplete form-control\"></div>',\n    inputTpl: '<div class=\"delegate-input\">\\\n        <input type=\"text\" class=\"input-delegate\">\\\n        <span class=\"input-delegate-sizer\">W</span>\\\n      </div>',\n    dropdownTpl: '<ul class=\"dropdown-menu\"></ul>',\n    placeholderTpl: '<div class=\"bs-autocomplete-placeholder\"></div>',\n    clearBtnTpl: '<span class=\"bsautocomplete-icon-cross bsautocomplete-font icon-jiaochacross78\"></span>',\n    dropdownItemTpl: '<li>\\\n        <a href=\"javascript:\">\\\n          <span class=\"text\"></span>\\\n        </a>\\\n      </li>',\n    badgeTpl: '<span class=\"label label-primary\">\\\n        <a href=\"javascript:\" class=\"badge-text\"></a>\\\n        <a href=\"javascript:\" class=\"badge-close\">x</a>\\\n      </span>'\n  };\n\n  // CLS\n  var CLS = {\n    badgeCt: 'bs-autocomplete-badge'\n  };\n\n  // escapeRegex\n  var escapeRegex = function (str) {\n    if (typeof str !== 'string') return str;\n    var matchOperatorsRe = /[|\\\\{}()[\\]^$+*?.]/g;\n    return str.replace(matchOperatorsRe, '\\\\$&');\n  };\n\n  // getInnerSize\n  var getInnerWidth = function (el) {\n    var padL = getCssNum(el, 'padding-left'), padR = getCssNum(el, 'padding-right');\n    return el.innerWidth() - padL - padR;\n  };\n\n  // getOuterWidth\n  var getOuterWidth = function (el) {\n    return el.outerWidth() + getCssNum(el, 'margin-left') + getCssNum(el, 'margin-right');\n  };\n\n  // getCaretPosition\n  var getCaretPosition = function (oField) {\n    var caretPos = 0;\n    if (document.selection) {// IE\n      var oSel = document.selection.createRange();\n      oSel.moveStart(\"character\", 0 - oField.value.length);\n      caretPos = oSel.text.length;\n    } else if (oField.selectionStart || oField.selectionStart == \"0\") { // Firefox\n      caretPos = oField.selectionStart;\n    }\n    return caretPos;\n  };\n\n  // getCssNum\n  var getCssNum = function (el, css) {\n    return Number(el.css(css).replace('px', ''));\n  };\n\n  // getOuterHtml\n  var ohtml = function (e) {\n    return $('<div></div>').append(e).html();\n  };\n\n  // setCaretPosition\n  var setCaretPosition = function (oField) {\n    if (document.selection) {// IE\n      var oSel = document.selection.createRange();\n      oSel.moveStart(\"character\", oField.value.length);\n    } else { // Firefox\n      oField.selectionStart = oField.value.length;\n    }\n  };\n\n  // stopEvent\n  var stopEvent = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  // isString\n  var isString = function (val) {\n    return typeof val === typeof '';\n  };\n\n  // PlaceHolder\n  var PlaceHolder = function (ac) {\n    var placeholder = this, placeholderEl = placeholder.el = $(TPLS.placeholderTpl).prependTo(ac.el);\n    placeholderEl.text(ac.params.placeHolder);\n\n    placeholder.refresh = function () {\n      if (ac.selectedItems.length > 0) placeholderEl.hide();\n      else placeholderEl.show();\n    };\n  };\n\n  // Badge\n  var Badge = function (ac) {\n    var badge = this;\n\n    // resize\n    badge.resize = function (el) {\n      if (el) {\n        var closeEl = el.find('.badge-close');\n        var badgeMarginL = getCssNum(el, 'margin-left'), badgeMarginR = getCssNum(el, 'margin-right');\n        var maxWidth = getInnerWidth(ac.el) - ac.input.emptyWidth - badgeMarginL - badgeMarginR - closeEl.outerWidth() - 2;\n        el.find('.badge-text').css('max-width', maxWidth + 'px');\n      } else {\n        ac.el.children('.' + CLS.badgeCt).each(function () {\n          badge.resize($(this));\n        });\n      }\n    };\n\n    // closeBadge\n    badge.closeBadge = function (badgeEl) {\n      badgeEl.find('.badge-close').click();\n    };\n\n    // getLastBadge\n    badge.getLastBadge = function () {\n      var badges = ac.el.children('.' + CLS.badgeCt);\n      if (badges.size() > 0) return $(badges[badges.size() - 1]);\n    };\n\n    // getCloestBadge\n    badge.getCloestBadge = function (mouseX, mouseY) {\n      var cloestBadgeEl, isLineMatched;\n      ac.el.children('.' + CLS.badgeCt).each(function () {\n        var badgeEl = $(this), pos = badgeEl.position();\n        var left = pos.left, top = pos.top, bottom = top + badgeEl.outerHeight(), right = pos.left + badgeEl.outerWidth();\n        if (mouseY >= top && mouseY <= bottom) {\n          isLineMatched = true;\n          if (mouseX <= left) {\n            cloestBadgeEl = badgeEl;\n            return false;\n          }\n        } else if (isLineMatched) {// matched last line last badge\n          cloestBadgeEl = badgeEl;\n          return false;\n        }\n      });\n      return cloestBadgeEl;\n    };\n\n    // add\n    badge.add = function (val, speicalData) {\n      var item = ac.panel.getSelectedItem();\n      if (!item) {\n        if (!val) {\n          delete ac.editingItem;\n          return;\n        }\n\n        if (ac.editingItem) {\n          if (val === ac.editingItem.item) item = val;\n          else if (isString(val)) {\n            if (ac.editingItem.text == val) item = ac.editingItem.item;\n          } else {\n            var ei = ac.editingItem.item, eiCode = ei.c || ei.code, eiName = ei.n || ei.name;\n            var valCode = ei.c || ei.code, valName = ei.n || ei.name;\n            if (valCode == eiCode && valName == eiName) item = val;\n          }\n        }\n\n        if (!item) {\n          var findItem;\n          if (isString(val)) {\n            findItem = ac.searchInData(val, speicalData);\n            if (!findItem && !ac.params.forceSelect) item = {c: val, n: val};\n          } else {\n            if (ac.params.forceSelect) {\n              findItem = ac.searchInData(val, speicalData);\n              if (findItem) item = findItem;\n            } else item = val;\n          }\n        }\n\n        if (!item) {\n          delete ac.editingItem;\n          return;\n        }\n      }\n      delete ac.editingItem;\n\n      var badgeEl, itemName = item.n || item.name;\n      if (ac.params.badgeRender) badgeEl = ac.params.badgeRender.call(ac, item);\n      else {\n        badgeEl = $(TPLS.badgeTpl);\n        var text = badgeEl.find('.badge-text');\n        if (ac.params.itemUseHtml) text.append(ohtml($(itemName)));\n        else text.text(itemName);\n        text.attr('title', itemName);\n      }\n\n      badgeEl.addClass(CLS.badgeCt + ' ' + ac.params.badgeCls).click(function (e) {\n        stopEvent(e);\n      });\n\n      // close handler\n      badgeEl.find('.badge-close').click(function (e) {\n        if (ac.isReadonly()) return;\n        badgeEl.remove();\n        ac.removeSelected(item);\n\n        if (ac.selectedItems.length <= 0) ac.input.blur();\n        ac.close();\n        ac.placeholder.refresh();\n        stopEvent(e);\n      });\n\n      // text handler\n      badgeEl.find('.badge-text')[ac.params.dblclick4Edit ? 'dblclick' : 'click'](function (e) {\n        if (ac.isReadonly()) return;\n\n        badgeEl.after(ac.input.el).remove();\n        ac.removeSelected(item);\n\n        var text = ac.isInSearchMode('name') ? item.n || item.name : item.c || item.code;\n        if (ac.params.getText4BadgeEdit) text = ac.params.getText4BadgeEdit.call(ac, item, text);\n        ac.editingItem = {item: item, text: text};\n        ac.close();\n        ac.input.updateTextValue(text);\n        stopEvent(e);\n      });\n\n      var doAdd = false;\n      if (ac.params.filtSame && ac.selectedItems.length > 0) {\n        var hasSame = ac.findSelectedItem(item) >= 0;\n        if (hasSame) {\n          if (ac.isSingleMode()) return true;\n        } else doAdd = true;\n      } else doAdd = true;\n\n      if (doAdd) {\n        if (ac.isSingleMode()) ac.el.children('.' + CLS.badgeCt).remove();\n        ac.input.el.before(badgeEl);\n        ac.addSelected(item, !speicalData);\n        badge.resize(badgeEl);\n        if (ac.isSingleMode()) ac.input.updateTextValue(itemName, false);\n        ac.placeholder.refresh();\n      }\n      return doAdd;\n    };\n\n    if (ac.isSingleMode()) ac.el.addClass('single-badge');\n  };\n\n  // Input\n  var Input = function (ac) {\n    var input = this, inputCt = input.el = $(TPLS.inputTpl).appendTo(ac.el);\n    var inputSizer = inputCt.children('.input-delegate-sizer');\n\n    var loadTimeout;\n    var inputEl = inputCt.children(':text').on({\n      'focus': function (e) {\n        if (ac.isReadonly()) {\n          inputEl.blur();\n          stopEvent(e);\n          return;\n        }\n\n        input.isFocused = true;\n        input.updateSizer();\n        ac.placeholder.el.hide();\n        ac.el.addClass('focus');\n        if (ac.params.minChar <= 0 || inputEl.val().length >= ac.params.minChar) ac.openOnFocus();\n        if (ac.isSingleMode() && ac.getValue().length > 0) {\n          setCaretPosition(inputEl[0]);\n          ac.editingItem = {item: ac.getValue()[0], text: inputEl.val()};\n        }\n        ac.fireOnFocus();\n      },\n      'blur': function () {\n        if (!input.isFocused) return;\n        input.isFocused = false;\n        ac.el.removeClass('focus');\n\n        if (inputEl.val() && !input.beforeMoveVal || !inputEl.val() && ac.isSingleMode())\n          input.confirmValue(false, true);\n        ac.placeholder.refresh();\n        ac.close();\n        ac.fireOnBlur();\n      },\n      'keydown': function (e) {\n        if (ac.isReadonly()) return;\n\n        input.updateSizer();\n\n        var specialKey = false;\n        switch (e.keyCode) {\n          case KEY_CODES.ENTER:\n            var item = ac.panel.getSelectedItem();\n            if (item) {\n              var itemName = item.n || item.name, itemCode = item.c || item.code;\n              if (ac.isInSearchMode('name') && itemName) inputEl.val(itemName);\n              else if (itemCode) inputEl.val(itemCode);\n            }\n            input.blur();\n            stopEvent(e);\n            specialKey = true;\n            break;\n          case KEY_CODES.ESC:\n            input.confirmValue(true);\n            specialKey = true;\n            break;\n          case KEY_CODES.TAB:\n            var hasVal = !!inputEl.val();\n            input.confirmValue();\n            if (hasVal && !ac.isSingleMode()) {\n              inputEl.focus();\n              stopEvent(e);\n            }\n            specialKey = true;\n            break;\n          case KEY_CODES.LEFT:\n          case KEY_CODES.RIGHT:\n            var caretPos = getCaretPosition(inputEl[0]), textLen = inputEl.val().length;\n            if (e.keyCode == KEY_CODES.LEFT && caretPos == 0) {\n              input.moveToLR(true);\n              stopEvent(e);\n            } else if (e.keyCode == KEY_CODES.RIGHT && caretPos == textLen) {\n              input.moveToLR(false);\n              stopEvent(e);\n            }\n            specialKey = true;\n            break;\n          case KEY_CODES.UP:\n          case KEY_CODES.DOWN:\n            ac.panel.moveSelect(e.keyCode == KEY_CODES.UP);\n            stopEvent(e);\n            specialKey = true;\n            break;\n          case KEY_CODES.BACK:\n            if (!inputEl.val()) {\n              var prevBadge = inputCt.prev('.' + CLS.badgeCt);\n              if (prevBadge.size() > 0) {\n                ac.badge.closeBadge(prevBadge);\n                stopEvent(e);\n                specialKey = true;\n              }\n            }\n            break;\n          case KEY_CODES.DELETE:\n            if (!inputEl.val()) {\n              var nextBadge = inputCt.next('.' + CLS.badgeCt);\n              if (nextBadge.size() > 0) {\n                ac.badge.closeBadge(nextBadge);\n                stopEvent(e);\n                specialKey = true;\n              }\n            }\n            break;\n          default:\n            ac.panel.relocate();\n        }\n\n        if (!specialKey) {\n          if (loadTimeout) clearTimeout(loadTimeout);\n          setTimeout(function () {\n            if (inputEl.val().length < ac.params.minChar) {\n              ac.close();\n              ac.panel.el.empty();\n              return;\n            }\n\n            ac.loadData().then(function () {\n              ac.open();\n              ac.panel.render();\n            });\n          }, ac.params.inputSearchDelay);\n        }\n      },\n      'keyup': function (e) {\n        if (ac.isReadonly()) return;\n        input.updateSizer();\n      }\n    });\n\n    // moveToLR\n    input.moveToLR = function (isLeft) {\n      if (ac.isSingleMode()) return;\n\n      var badge = isLeft ? inputCt.prev('.' + CLS.badgeCt + ' ') : inputCt.next('.' + CLS.badgeCt);\n      if (badge) {\n        input.beforeMoveVal = inputEl.val();\n        isLeft ? badge.before(inputCt) : badge.after(inputCt);\n        inputEl.val(input.beforeMoveVal);\n        input.focus();\n        delete input.beforeMoveVal;\n      }\n    };\n\n    // moveToBadge\n    input.moveToBadge = function (badge) {\n      if (ac.isSingleMode()) return;\n\n      if (badge) badge.before(input.el);\n      else {\n        var lastBadge = ac.badge.getLastBadge();\n        if (lastBadge) lastBadge.after(input.el);\n      }\n    };\n\n    // updateSizer\n    input.updateSizer = function () {\n      inputSizer.text(inputEl.val() + 'WW');\n    };\n\n    // updateTextValue\n    input.updateTextValue = function (text, focus) {\n      inputEl.val(text);\n      if (!input.isFocused && focus !== false) input.focus();\n      input.updateSizer();\n      setCaretPosition(inputEl[0]);\n    };\n\n    // confirmValue\n    input.confirmValue = function (isEsc, fromBlur) {\n      var added;\n\n      if (isEsc) {\n        if (ac.editingItem) added = ac.badge.add(ac.editingItem.item);\n      } else added = ac.badge.add(inputEl.val());\n\n      if (ac.isSingleMode()) {\n        if (!added) {\n          if (ac.selectedItems.length > 0) ac.removeSelected(ac.selectedItems[0]);\n          if (inputEl.val()) input.clear();\n        }\n        if (!fromBlur) inputEl.blur();\n        ac.close();\n      } else if (inputEl.val()) input.clear();\n    };\n\n    // blur\n    input.blur = function () {\n      if (!input.isFocused) return;\n      inputEl.blur();\n    };\n\n    // clear\n    input.clear = function (fireBlur) {\n      inputEl.val('');\n      if (fireBlur === false) ac.placeholder.refresh();\n      else inputEl.blur();\n      inputSizer.text('W');\n    };\n\n    // getSearchText\n    input.getSearchText = function () {\n      return inputEl.val();\n    };\n\n    // focus\n    input.focus = function () {\n      if (input.isFocused) return;\n      inputEl.focus();\n    };\n\n    inputSizer.text('WW');\n    input.emptyWidth = getOuterWidth(inputCt);\n    inputSizer.text('W');\n  };\n\n  // DropdownPanel\n  var DropdownPanel = function (ac) {\n    var panel = this, panelEl = panel.el = $(TPLS.dropdownTpl).appendTo(ac.el);\n\n    // moveSelect\n    panel.moveSelect = function (isUp) {\n      var selItem = panelEl.children('li.selected'), moveToItem;\n      if (selItem.size() > 0) {\n        moveToItem = isUp ? selItem.prev() : selItem.next();\n        if (moveToItem.size() <= 0) {\n          var items = panelEl.children();\n          moveToItem = isUp ? $(items[items.size() - 1]) : $(items[0]);\n        }\n      } else {\n        var items = panelEl.children();\n        if (items.size() > 0) moveToItem = isUp ? $(items[items.size() - 1]) : $(items[0]);\n      }\n\n      if (moveToItem && moveToItem.length > 0) {\n        selItem.removeClass('selected');\n        moveToItem.addClass('selected');\n        panel.scrollToSelected(moveToItem);\n      }\n    };\n\n    // scrollToSelected\n    panel.scrollToSelected = function (selectedItem) {\n      selectedItem = selectedItem || panelEl.children('li.selected');\n      if (selectedItem.size() > 0) {\n        var scrollTop = panelEl.scrollTop(), top = selectedItem.position().top + scrollTop;\n        top = top - (panelEl.height() - selectedItem.height()) / 2;\n        panelEl.scrollTop(top);\n      }\n    };\n\n    // getSelectedItem\n    panel.getSelectedItem = function () {\n      return panelEl.children('li.selected').data('bsAutoCompleteItem');\n    };\n\n    // render\n    panel.render = function () {\n      var data = ac.data || [], searchText = ac.input.getSearchText();\n      panelEl.empty();\n\n      var ei = ac.editingItem && ac.editingItem.item || {}, eiCode = ei.c || ei.code, eiName = ei.n || ei.name;\n      if (data.length > 0) {\n        var matched = false;\n        $.each(data, function (i, item) {\n          var itemEl, itemName = item.n || item.name, itemCode = item.c || item.code;\n          if (ac.params.itemRender) ac.params.itemRender.call(ac, itemEl, item, searchText);\n          else {\n            itemEl = $(TPLS.dropdownItemTpl);\n            var text = itemEl.find('.text');\n            if (ac.params.itemUseHtml) text.append(ohtml($(itemName)));\n            else text.text(itemName);\n          }\n\n          itemEl.addClass('bs-autocomplete-item').data('bsAutoCompleteItem', item).appendTo(panelEl)\n              .mousedown(function (e) {\n                if (ac.isReadonly()) return;\n\n                ac.input.clear();\n                ac.badge.add(item);\n                stopEvent(e);\n              });\n\n          if (!matched && searchText) {\n            if (ac.editingItem && ac.editingItem.text == searchText) {\n              if (eiCode == itemCode && eiName == itemName)\n                matched = true;\n            }\n            if (ac.isInSearchMode('name') && searchText == itemName) {\n              matched = true;\n            } else if (ac.isInSearchMode('code') && searchText == itemCode) {\n              matched = true;\n            }\n            if (matched) itemEl.addClass('selected');\n          }\n        });\n      } else ac.close();\n    };\n\n    // resize\n    panel.resize = function () {\n      panelEl.css('max-width', ac.el.width());\n    };\n\n    // relocate\n    panel.relocate = function () {\n      var inputPosLeft = ac.input.el.position().left;\n      if (ac.isSingleMode()) inputPosLeft = 0;\n      panelEl.css('left', inputPosLeft + 'px');\n    };\n\n    // close\n    panel.close = function () {\n      panelEl.children().removeClass('selected');\n    };\n\n    // destroy\n    panel.destroy = function () {\n      panelEl.children().each(function () {\n        $(this).removeData('bsAutoCompleteItem');\n      });\n      panelEl.remove();\n    };\n  };\n\n  // AutoComplete\n  var AutoComplete = function (params, originEl) {\n    var ac = this;\n    params = params || {};\n    for (var def in DEF_OPTS) if (typeof params[def] === 'undefined') params[def] = DEF_OPTS[def];\n    ac.params = params, ac.initialized = false, ac.selectedItems = [], ac.readonly = false;\n\n    // htmlOverHandler\n    var htmlOverHandler = function () {\n      if (!ac.resized4htmlOver) {\n        if (ac.el.is(':visible')) ac.resize();\n        $('html').off('mouseover', htmlOverHandler);\n        ac.resized4htmlOver = true;\n      }\n    };\n\n    // htmlClickHandler\n    var htmlClickHandler = function (e) {\n      if (!ac.el.hasClass('open')) return;\n      if ($(e.target).hasClass('bootstrap-autocomplete')) return;\n\n      var autocomplete = $(e.target).parents('.bootstrap-autocomplete');\n      if (autocomplete.size() == 0) ac.close();\n      else if (autocomplete[0] != ac.el[0]) ac.close();\n    };\n\n    // htmlResizeHandler\n    var resizeTimeout;\n    var htmlResizeHandler = function (e) {\n      if (resizeTimeout) clearTimeout(resizeTimeout);\n      setTimeout(function () {\n        ac.panel.resize();\n      }, 100);\n    };\n\n    // elOverHandler\n    var elOverHandler = function () {\n      if (!ac.resized4elOver) {\n        if (ac.el.is(':visible')) ac.resize();\n        ac.el.off('mouseover', elOverHandler);\n        ac.resized4elOver = true;\n      }\n    };\n\n    // addValue\n    ac.addValue = function (items, opts) {\n      opts = $.extend({onSuccess: $.noop}, opts || {});\n\n      var oldSelectedItems = ac.getValue();\n      if (opts.clear) ac.clearValue(false);\n      if (!items) {\n        opts.fireInit ? ac.fireOnInit() : ac.fireOnChange(oldSelectedItems, ac.getValue());\n        return;\n      }\n\n      if (!(items instanceof Array)) {\n        if (isString(items)) items = [{c: items, n: items}];\n        else items = [items];\n      } else if (items.length <= 0) {\n        return;\n      } else {\n        var formatedItems = [];\n        $.each(items, function (i, item) {\n          if (isString(item)) formatedItems.push({c: item, n: item});\n          else formatedItems.push(item);\n        });\n        items = formatedItems;\n      }\n\n      if (ac.params.forceSelect && ac.params.loadDataItems) {\n        ac.loadDataItems(items).then(function (tmpData) {\n          $.each(items, function (i, item) {\n            ac.badge.add(item, tmpData);\n          });\n          opts.fireInit ? ac.fireOnInit() : ac.fireOnChange(oldSelectedItems, ac.getValue());\n          opts.onSuccess.call(ac);\n        }, function () {\n          if (opts.fireInit) ac.fireOnInit();\n        });\n      } else {\n        var lastSearchData = ac.data, needCheckRemote = ac.params.forceSelect && ac.params.loadData;\n        var toCheckCount = items.length, checkedItemCount = 0;\n        if (items.length > 0 && !needCheckRemote) ac.data = (ac.params.data || []).slice();\n        $.each(items, function (i, item) {\n          if (needCheckRemote) {\n            if (ac.searchInData(item, lastSearchData)) {\n              ac.badge.add(item);\n              checkedItemCount++;\n            } else {\n              var itemCode = item.c || item.code, itemName = item.n || item.name;\n              var searchText = ac.isInSearchMode('code') ? itemCode : itemName, tmpData = [];\n              ac.loadData(searchText, tmpData).then(function (tmpData) {\n                lastSearchData = tmpData;\n                ac.badge.add(item, tmpData);\n              }).always(function () {\n                if (++checkedItemCount == toCheckCount) {\n                  opts.fireInit ? ac.fireOnInit() : ac.fireOnChange(oldSelectedItems, ac.getValue());\n                  opts.onSuccess.call(ac);\n                }\n              });\n            }\n          } else ac.badge.add(item);\n        });\n        if (!needCheckRemote) {\n          opts.fireInit ? ac.fireOnInit() : ac.fireOnChange(oldSelectedItems, ac.getValue());\n          opts.onSuccess.call(ac);\n        }\n      }\n    };\n\n    // setValue\n    ac.setValue = function (items, opts) {\n      opts = $.extend(opts || {}, {clear: true});\n      ac.addValue(items, opts);\n    };\n\n    // openOnFocus\n    ac.openOnFocus = function () {\n      ac.loadData().then(function () {\n        ac.open();\n        ac.panel.render();\n      });\n    };\n\n    // isInSearchMode\n    ac.isInSearchMode = function (mode) {\n      return ac.params.searchMode.indexOf(mode) >= 0;\n    };\n\n    // resize\n    ac.resize = function () {\n      ac.badge.resize();\n    };\n\n    // destroy\n    ac.destroy = function () {\n      ac.panel.destroy();\n      $('html').off({'click': htmlClickHandler, 'mouseover': htmlOverHandler});\n      $(window).off('resize', htmlResizeHandler);\n      ac.params.el.removeData(\"bsAutoComplete\");\n      ac.el.remove();\n    };\n\n    // fireOnChange\n    ac.fireOnChange = function (oldItems, newItems) {\n      ac.params.el.trigger('bs.autocomplete.change', [oldItems, newItems]);\n    };\n\n    // fireOnSelect\n    ac.fireOnSelect = function (item, items) {\n      ac.params.el.trigger('bs.autocomplete.select', [item, items]);\n    };\n\n    // fireOnInit\n    ac.fireOnInit = function () {\n      ac.params.el.trigger('bs.autocomplete.inited');\n    };\n\n    // fireOnFocus\n    ac.fireOnFocus = function () {\n      ac.params.el.trigger('bs.autocomplete.focus');\n    };\n\n    // fireOnBlur\n    ac.fireOnBlur = function () {\n      ac.params.el.trigger('bs.autocomplete.blur');\n    };\n\n    // fireOnDeSelect\n    ac.fireOnDeSelect = function (item, items) {\n      ac.params.el.trigger('bs.autocomplete.deselect', [item, items]);\n    };\n\n    // is\n    ac.isSingleMode = function () {\n      return !ac.params.multiple;\n    };\n\n    // close\n    ac.close = function () {\n      ac.el.removeClass('open');\n      ac.panel.close();\n    };\n\n    // open\n    ac.open = function () {\n      if (ac.readonly) return;\n      ac.panel.resize();\n      ac.panel.relocate();\n      ac.el.addClass('open');\n    };\n\n    // getValue\n    ac.getValue = function () {\n      return ac.selectedItems.slice();\n    };\n\n    // clearData\n    ac.clearData = function () {\n      ac.data.splice(0, ac.data.length);\n    };\n\n    // clearValue\n    ac.clearValue = function (fire) {\n      if (ac.isSingleMode()) ac.input.clear(fire);\n\n      var oldSelectedItems = ac.getValue();\n      ac.selectedItems.splice(0, ac.selectedItems.length);\n      ac.el.children('.' + CLS.badgeCt).remove();\n      ac.el.removeClass('selected');\n      ac.placeholder.refresh();\n      if (fire !== false) {\n        ac.params.el.trigger('bs.autocomplete.clear');\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    // setReadonly\n    ac.setReadonly = function (readonly) {\n      readonly = readonly !== false;\n      ac.readonly = readonly;\n      if (readonly) ac.el.addClass('readonly');\n      else ac.el.removeClass('readonly');\n    };\n\n    // isReadonly\n    ac.isReadonly = function () {\n      return ac.readonly;\n    };\n\n    // addSelected\n    ac.addSelected = function (item, fire) {\n      var oldSelectedItems = ac.selectedItems.slice();\n\n      if (ac.isSingleMode()) ac.selectedItems.splice(0, ac.selectedItems.length);\n\n      ac.selectedItems.push(item);\n      if (ac.selectedItems.length > 0) ac.el.addClass('selected');\n\n      if (fire !== false) {\n        ac.fireOnSelect(item, ac.getValue());\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    // removeSelected\n    ac.removeSelected = function (item) {\n      var findIndex = ac.findSelectedItem(item);\n      if (findIndex >= 0) {\n        var oldSelectedItems = ac.selectedItems.slice();\n        ac.selectedItems.splice(findIndex, 1);\n        if (ac.selectedItems.length <= 0) ac.el.removeClass('selected');\n\n        ac.fireOnDeSelect(item, ac.getValue());\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    // isItemMatched\n    ac.isItemMatched = function (searchText, item) {\n      var regex = new RegExp(escapeRegex(searchText), ac.params.ignoreCase ? 'i' : undefined);\n      var matched = false;\n      if (ac.isInSearchMode('name')) matched = regex.test(item.n || item.name);\n      if (!matched && ac.isInSearchMode('code')) matched = regex.test(item.c || item.code);\n      return matched;\n    };\n\n    // findSelectedItem\n    ac.findSelectedItem = function (item) {\n      var result = -1, itemCode = item.c || item.code, itemName = item.n || item.name;\n      $.each(ac.selectedItems, function (i, selItem) {\n        var selCode = selItem.c || selItem.code, selName = selItem.n || selItem.name;\n        if (selCode == itemCode && selName == itemName) {\n          result = i;\n          return false;\n        }\n      });\n      return result;\n    };\n\n    // searchInData\n    ac.searchInData = function (item, data) {\n      var isFromStr = isString(item);\n      if (isFromStr) item = {c: item, n: item};\n      var findItem, itemCode = item.c || item.code, itemName = item.n || item.name, data = data || ac.data;\n\n      $.each(data, function (i, dataItem) {\n        var dataCode = dataItem.c || dataItem.code, dataName = dataItem.n || dataItem.name;\n        if (isFromStr) {\n          if (ac.isInSearchMode('name') && dataName == itemName || ac.isInSearchMode('code') && dataCode == itemCode) {\n            findItem = dataItem;\n            return false;\n          }\n        } else {\n          if (dataName == itemName && dataCode == itemCode) {\n            findItem = dataItem;\n            return false;\n          }\n        }\n      });\n      return findItem;\n    };\n\n    // loadDataItems\n    ac.loadDataItems = function (items) {\n      var defered = $.Deferred();\n      var loadedItems = [];\n\n      ac.params.loadDataItems.call(ac, items, function (data) {\n        if (data) {\n          $.each(data, function (i, item) {\n            if (isString(item)) item = {c: item, n: item};\n            loadedItems.push(item);\n          });\n          defered.resolve(loadedItems);\n        } else defered.reject();\n      });\n\n      return defered.promise();\n    };\n\n    // loadData\n    ac.loadData = function (searchText, specialData) {\n      searchText = searchText || ac.input.getSearchText();\n      var defered = $.Deferred();\n\n      specialData = specialData || ac.data;\n      specialData.splice(0, specialData.length);\n      if (ac.params.loadData) {\n        ac.params.loadData.call(ac, searchText, function (data) {\n          if (data) {\n            $.each(data, function (i, item) {\n              if (isString(item)) item = {c: item, n: item};\n              specialData.push(item);\n            });\n            defered.resolve(specialData);\n          } else defered.reject();\n        });\n      } else {\n        var data = ac.params.data || [];\n        $.each(data, function (i, item) {\n          if (isString(item)) item = {c: item, n: item};\n          if (searchText && !ac.isItemMatched(searchText, item)) return;\n          specialData.push(item);\n        });\n        defered.resolve(specialData);\n      }\n      return defered.promise();\n    };\n\n    ac.data = [], ac.el = $(TPLS.containerTpl).addClass(ac.params.cls);\n    if (ac.params.fitWdith !== false) ac.el.addClass('fit-width');\n    if (ac.params.dropUp) ac.el.addClass('dropup');\n    if (ac.params.replace) {\n      ac.el.insertAfter(params.el);\n      params.el.hide();\n    } else ac.el.appendTo(params.el);\n    ac.input = new Input(ac);\n    ac.panel = new DropdownPanel(ac);\n    ac.badge = new Badge(ac);\n    ac.placeholder = new PlaceHolder(ac);\n    if (ac.params.data) {\n      $.each(ac.params.data, function (i, item) {\n        if (isString(item)) ac.data.push({c: item, n: item});\n        else ac.data.push(item);\n      });\n      ac.params.data = ac.data.slice();\n    }\n\n    { // clear btn\n      $(TPLS.clearBtnTpl).appendTo(ac.el).click(function (e) {\n        if (ac.isReadonly()) return;\n\n        ac.clearValue();\n        stopEvent(e);\n      });\n    }\n\n    if (ac.params.readonly) ac.setReadonly(true);\n\n    ac.el.on({\n      mousedown: function (e) {\n        if (ac.isReadonly()) return;\n\n        if (e.target == ac.el[0]) {\n          var badge = ac.badge.getCloestBadge(e.offsetX, e.offsetY);\n          ac.input.moveToBadge(badge);\n          if (ac.input.isFocused) stopEvent(e);\n          //ac.input.focus();\n        }\n      },\n      click: function (e) {\n        if (ac.isReadonly()) return;\n        ac.input.focus();\n      },\n      mouseover: elOverHandler\n    });\n\n    originEl.data(\"bsAutoComplete\", this);\n    if (ac.params.value) ac.setValue(ac.params.value, {fireInit: true});\n    else ac.fireOnInit();\n\n    $('html').on({'click': htmlClickHandler, 'mouseover': htmlOverHandler});\n    $(window).on('resize', htmlResizeHandler);\n  };\n\n  $.fn.bsAutoComplete = function (params) {\n    var args = arguments;\n    return this.each(function () {\n      if (!this) return;\n      var $this = $(this);\n\n      var bsAutoComplete = $this.data(\"bsAutoComplete\");\n      if (!bsAutoComplete && params != 'destroy') {\n        params = $.extend({\n          el: $this, value: $this.val() ? $this.val().split(params.splitChar || ' ') : ''\n        }, params);\n        bsAutoComplete = new AutoComplete(params, $this);\n      }\n      if (bsAutoComplete && isString(params))\n        bsAutoComplete[params].apply(bsAutoComplete, Array.prototype.slice.call(args, 1));\n    });\n  }\n\n})(jQuery);\n"]}