{"version":3,"sources":["js/bootstrap-autocomplete.js"],"names":["$","DEF_OPTS","cls","placeHolder","emptyListTip","searchMode","ignoreCase","fitWdith","dropUp","filtSame","badgeCls","dblclick4Edit","inputSearchDelay","forceSelect","minChar","multiple","mode","hideBadge","debounceFn","delay","fn","atBegin","debounce","mockDebounceTimeout","lastTimeoutId","now","Date","getTime","clearTimeout","setTimeout","isIE","navigator","userAgent","indexOf","KEY_CODES","TPLS","inputDelegateContainerTpl","containerTpl","inputTpl","dropdownTpl","dropdownTopBarTpl","placeholderTpl","clearBtnTpl","emptyDropDownItemTpl","dropdownItemTpl","badgeTpl","CLS","MODE","selectOption","getCssNum","el","css","Number","replace","ohtml","e","append","html","setCaretPosition","oField","document","selection","createRange","moveStart","value","length","selectionStart","stopEvent","preventDefault","stopPropagation","isString","val","PlaceHolder","ac","placeholderEl","this","params","tpls","prependTo","text","refresh","selectedItems","hide","show","Badge","badge","resize","closeEl","find","badgeMarginL","badgeMarginR","maxWidth","padL","padR","innerWidth","input","emptyWidth","outerWidth","children","each","findSelectedBadgeEl","item","foundBadgeEl","itemName","n","name","itemCode","c","code","badgeEl","badgeItem","data","badgeItemName","badgeItemCode","closeBadge","opts","isReadonly","remove","removeSelected","isOpen","itemEl","panel","findItemEl","removeClass","closePanel","blur","close","placeholder","fireBadgeRemoved","getLastBadge","badges","size","getCloestBadge","mouseX","mouseY","cloestBadgeEl","isLineMatched","pos","position","left","top","bottom","outerHeight","addBadge","speicalData","editingItem","ei","eiCode","eiName","valCode","valName","searchInData","optGroup","customNameHtml","hn","htmlName","badgeRender","call","itemUseHtml","attr","addClass","click","isSelectOptionMode","after","isInSearchMode","getText4BadgeEdit","updateTextValue","doAdd","isSingleMode","findSelectedItem","before","addSelected","fire","Input","loadTimeout","compositionFlag","inputCt","appendTo","inputSizer","inputEl","loadDataOnInput","destoried","empty","loadData","from","then","isFocused","open","render","on","focus","updateSizer","openOnFocus","getValue","fireOnFocus","preventBlur","relatedTarget","closest","beforeMoveVal","confirmValue","fromBlur","fireOnBlur","keydown","specialKey","keyCode","undefined","getSelectedItemEl","isSelected","hasVal","caretPos","oSel","getCaretPosition","textLen","moveToLR","moveSelect","prevBadge","prev","nextBadge","next","relocate","keyup","compositionstart","compositionend","isLeft","moveToBadge","lastBadge","isEsc","added","clear","fireBlur","getSearchText","mousedown","DropdownPanel","panelEl","emptyItemEl","currentTarget","scrollTop","innerHeight","scrollHeight","delta","originalEvent","wheelDelta","detail","foundItemEl","checkedItemEls","i","$itemEl","boundItem","boundItemName","boundItemCode","isUp","moveToItem","selItem","itemCls","skipMultiSel","hideOtherSelected4Multiple","hasClass","items","scrollToSelected","selectedItem","height","initMenuBar","menuBarEl","searchText","hasOptGroup","lastGroupEl","matched","isMultiMode","lastGroupChildCount","selectableItemCount","toLowerCase","selectable","itemRender","selectedItemMap","width","fireOnPanelResize","inputPosLeft","destroy","removeData","AutoComplete","originEl","def","extend","initialized","readonly","htmlOverHandler","resized4htmlOver","is","off","htmlClickHandler","target","autocomplete","parents","htmlResizeHandler","elOverHandler","resized4elOver","addValue","onSetFinish","noop","changeFired","oldSelectedItems","clearValue","fireInit","fireOnInit","fireOnChange","Array","formatedItems","push","loadDataItems","tmpData","specialData","always","lastSearchData","needCheckRemote","toCheckCount","checkedItemCount","slice","showAllItemsWhenFirstFocus","setValue","showAllWhenSingleForceSelectFocus","mouseover","window","oldItems","newItems","allItemsSame","oldItem","oldItemCode","oldItemName","newItem","newItemCode","newItemName","disableResizeContainer","resizeContainer","containerEl","trigger","fireOnSelect","fireOnClose","inputGroupEl","isInitialized","fireOnPen","fireOnDeSelect","closeTime","clearData","splice","renderSelectedItemsInfo","setReadonly","findIndex","itemNames","join","isItemMatched","regex","RegExp","str","escapeRegex","test","result","selCode","selName","isFromStr","findItem","dataItem","dataCode","dataName","defered","Deferred","loadedItems","resolve","reject","promise","loadDataSeq","loadSeq","_loadSeq","nLoadSeq","isNaN","lastGroupItem","inputDelegateCtEl","isUnderInputGroup","isOriginInputEl","parent","insertAfter","bsAcCtEl","resizeHeightCls","offsetX","offsetY","bsAutoComplete","args","arguments","$this","split","splitChar","apply","prototype","jQuery"],"mappings":"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","file":"bootstrap-autocomplete.min.js","sourcesContent":["(function ($) {\n  'use strict';\n\n  // DEF_OPTS\n  var DEF_OPTS = {\n    cls             : '',\n    placeHolder     : '请选择',\n    emptyListTip    : '未找到匹配的数据项',\n    searchMode      : 'code name',\n    ignoreCase      : true,\n    fitWdith        : true,\n    dropUp          : false,\n    filtSame        : false,\n    badgeCls        : '',\n    dblclick4Edit   : false,\n    inputSearchDelay: 200,\n    forceSelect     : false,\n    minChar         : 1,\n    multiple        : true,\n    mode            : '',\n    hideBadge       : false,\n    debounceFn      : function (delay, fn, atBegin) {\n      if ($.debounce) return $.debounce(delay, atBegin, fn);\n      else {\n        var mockDebounceTimeout = -1, lastTimeoutId = -1;\n        return function () {\n          var now = +new Date().getTime();\n          if (mockDebounceTimeout < 0 || (now - mockDebounceTimeout) > delay) {\n            mockDebounceTimeout = now;\n\n            if (lastTimeoutId > 0) {\n              clearTimeout(lastTimeoutId);\n              lastTimeoutId = -1;\n            }\n\n            lastTimeoutId = setTimeout(function () {\n              lastTimeoutId = -1;\n              mockDebounceTimeout = -1;\n              fn();\n            }, delay);\n          }\n        }\n      }\n    }\n  };\n\n  var isIE = navigator.userAgent.indexOf('Trident') > -1;\n\n  // KEY_CODES\n  var KEY_CODES = {\n    ENTER: 13, TAB: 9, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40, ESC: 27, BACK: 8, DELETE: 46\n  };\n\n  // TPLS\n  var TPLS = {\n    inputDelegateContainerTpl: '<div class=\"input-delegate-ct\"></div>',\n    containerTpl             : '<div class=\"btn-group bootstrap-autocomplete form-control\">\\\n        <div class=\"selected-items-info\"></div>\\\n      </div>',\n    inputTpl                 : '<div class=\"delegate-input\">\\\n        <input type=\"text\" class=\"input-delegate\">\\\n        <span class=\"input-delegate-sizer\">W</span>\\\n      </div>',\n    dropdownTpl              : '<ul class=\"dropdown-menu bs-autocomplete-menu\"></ul>',\n    dropdownTopBarTpl        : '<div class=\"bs-autocomplete-menu-bar\"><a class=\"btn btn-default selrev-btn\">反选</a><a class=\"btn btn-default selall-btn\">全选</a></div>',\n    placeholderTpl           : '<div class=\"bs-autocomplete-placeholder\"></div>',\n    clearBtnTpl              : '<span class=\"bsautocomplete-icon-cross bsautocomplete-font icon-jiaochacross78\"></span>',\n    emptyDropDownItemTpl     : '<li class=\"bs-autocomplete-empty-item\"></li>',\n    dropdownItemTpl          : '<li>\\\n        <a href=\"javascript:\">\\\n          <span class=\"text\"></span>\\\n          <span class=\"item-status-icon glyphicon glyphicon-ok\"></span>\\\n        </a>\\\n      </li>',\n    badgeTpl                 : '<span class=\"label label-primary\">\\\n        <a href=\"javascript:\" class=\"badge-text\"></a>\\\n        <a href=\"javascript:\" class=\"badge-close\">x</a>\\\n      </span>'\n  };\n\n  // CLS\n  var CLS = {\n    badgeCt           : 'bs-autocomplete-badge',\n    badgeHide         : 'bs-autocomplete-badge-hide',\n    dropdownItem      : 'bs-autocomplete-item', // 分组optGroup === true项不会添加这个样式\n    multiSelected     : 'multiple-selected',\n    multiHideSel      : 'multiple-hide-selected',\n    itemSelected      : 'selected', // 进作为光标移动当前菜单项高亮用，不作为已选中项样式\n    itemChecked       : 'item-checked', // 已选中菜单项样式\n    clearBtnClass     : 'bs-autocomplete-clear-btn',\n    inputClearBtnClass: 'bs-autocomplete-input-clear-btn',\n    hasInputVal       : 'has-input-val',\n    emptyList         : 'empty-list',\n    modePrefix        : 'bs-autocomplete-mode-',\n  };\n\n  var MODE = {\n    selectOption: 'selectOption',\n  };\n\n  // escapeRegex\n  var escapeRegex = function (str) {\n    if (typeof str !== 'string') return str;\n    var matchOperatorsRe = /[|\\\\{}()[\\]^$+*?.]/g;\n    return str.replace(matchOperatorsRe, '\\\\$&');\n  };\n\n  // getInnerSize\n  var getInnerWidth = function (el) {\n    var padL = getCssNum(el, 'padding-left'), padR = getCssNum(el, 'padding-right');\n    return el.innerWidth() - padL - padR;\n  };\n\n  // getOuterWidth\n  var getOuterWidth = function (el) {\n    return el.outerWidth() + getCssNum(el, 'margin-left') + getCssNum(el, 'margin-right');\n  };\n\n  // getCaretPosition\n  var getCaretPosition = function (oField) {\n    var caretPos = 0;\n    if (document.selection) {// IE\n      var oSel = document.selection.createRange();\n      oSel.moveStart(\"character\", 0 - oField.value.length);\n      caretPos = oSel.text.length;\n    } else if (oField.selectionStart || oField.selectionStart == \"0\") { // Firefox\n      caretPos = oField.selectionStart;\n    }\n    return caretPos;\n  };\n\n  // getCssNum\n  var getCssNum = function (el, css) {\n    return Number(el.css(css).replace('px', ''));\n  };\n\n  // getOuterHtml\n  var ohtml = function (e) {\n    return $('<div></div>').append(e).html();\n  };\n\n  // setCaretPosition\n  var setCaretPosition = function (oField) {\n    if (document.selection) {// IE\n      var oSel = document.selection.createRange();\n      oSel.moveStart(\"character\", oField.value.length);\n    } else { // Firefox\n      oField.selectionStart = oField.value.length;\n    }\n  };\n\n  // stopEvent\n  var stopEvent = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  // isString\n  var isString = function (val) {\n    return typeof val === typeof '';\n  };\n\n  // PlaceHolder\n  var PlaceHolder = function (ac) {\n    var placeholder = this, placeholderEl = placeholder.el = $(ac.params.tpls.placeholderTpl).prependTo(ac.el);\n    placeholderEl.text(ac.params.placeHolder);\n\n    placeholder.refresh = function () {\n      if (ac.selectedItems.length > 0) placeholderEl.hide();\n      else placeholderEl.show();\n    };\n  };\n\n  // Badge\n  var Badge = function (ac) {\n    var badge = this;\n\n    // resize\n    badge.resize = function (el) {\n      if (el) {\n        var closeEl = el.find('.badge-close');\n        var badgeMarginL = getCssNum(el, 'margin-left'), badgeMarginR = getCssNum(el, 'margin-right');\n        var maxWidth = getInnerWidth(ac.el) - ac.input.emptyWidth - badgeMarginL - badgeMarginR - closeEl.outerWidth() - 2;\n        el.find('.badge-text').css('max-width', maxWidth + 'px');\n      } else {\n        ac.el.children('.' + CLS.badgeCt).each(function () {\n          badge.resize($(this));\n        });\n      }\n    };\n\n    // findSelectedBadgeEl\n    badge.findSelectedBadgeEl = function (item) {\n      if (!item) return;\n\n      var foundBadgeEl, codeMatched, nameMatched;\n      var itemName = item.n || item.name, itemCode = item.c || item.code;\n\n      // var editingItem = ac.editingItem && ac.editingItem.item;\n      // if (editingItem === item)\n      // if (!!editingItem) {\n      //   var badgeItemName = editingItem.n || editingItem.name,\n      //     badgeItemCode = editingItem.c || editingItem.code;\n      //\n      // }\n\n      ac.el.children('.' + CLS.badgeCt).each(function () {\n        var badgeEl = $(this);\n        var badgeItem = badgeEl.data('bsAutoCompleteItem');\n        if (!badgeItem) return;\n\n        var badgeItemName = badgeItem.n || badgeItem.name, badgeItemCode = badgeItem.c || badgeItem.code;\n        var isCodeMatch = badgeItemCode === itemCode, isNameMatch = badgeItemName === itemName;\n        if (badgeItem === item) {\n          foundBadgeEl = badgeEl;\n          return false;\n        } else if (isCodeMatch && isNameMatch) {\n          codeMatched = nameMatched = true;\n          foundBadgeEl = badgeEl;\n        }\n      });\n\n      return foundBadgeEl;\n    };\n\n    // closeBadge\n    badge.closeBadge = function (badgeEl, opts) {\n      opts = opts || {};\n\n      if (ac.isReadonly()) return;\n      var item = badgeEl.data('bsAutoCompleteItem');\n      badgeEl.remove();\n      ac.removeSelected(item);\n\n      if (ac.isOpen()) {\n        var itemEl = opts.itemEl || ac.panel.findItemEl(item);\n        if (itemEl) itemEl.removeClass(CLS.itemChecked);\n\n        if (opts.closePanel !== false) {\n          if (ac.selectedItems.length <= 0) ac.input.blur();\n          ac.close();\n        }\n      }\n\n      ac.placeholder.refresh();\n      ac.fireBadgeRemoved();\n    };\n\n    // getLastBadge\n    badge.getLastBadge = function () {\n      var badges = ac.el.children('.' + CLS.badgeCt);\n      if (badges.size() > 0) return $(badges[badges.size() - 1]);\n    };\n\n    // getCloestBadge\n    badge.getCloestBadge = function (mouseX, mouseY) {\n      var cloestBadgeEl, isLineMatched;\n      ac.el.children('.' + CLS.badgeCt).each(function () {\n        var badgeEl = $(this), pos = badgeEl.position();\n        var left = pos.left, top = pos.top, bottom = top + badgeEl.outerHeight(),\n          right = pos.left + badgeEl.outerWidth();\n        if (mouseY >= top && mouseY <= bottom) {\n          isLineMatched = true;\n          if (mouseX <= left) {\n            cloestBadgeEl = badgeEl;\n            return false;\n          }\n        } else if (isLineMatched) {// matched last line last badge\n          cloestBadgeEl = badgeEl;\n          return false;\n        }\n      });\n      return cloestBadgeEl;\n    };\n\n    // addBadge\n    badge.addBadge = function (val, opts) {\n      opts = opts || {};\n      var speicalData = opts.speicalData;\n      var item;\n\n      // if (!isString(val) && item && item !== val) {\n      //   var valCode = val.c || val.code, valName = val.n || val.name;\n      //   var itemCode = item.c || item.code, itemName = item.n || item.name;\n      //   if (valCode !== itemCode || valName !== itemName) item = val;\n      // }\n\n      if (!val) {\n        delete ac.editingItem;\n        return;\n      }\n\n      if (ac.editingItem) {\n        if (val === ac.editingItem.item) item = val;\n        else if (isString(val)) {\n          if (ac.editingItem.text === val) item = ac.editingItem.item;\n        } else {\n          var ei = ac.editingItem.item, eiCode = ei.c || ei.code, eiName = ei.n || ei.name;\n          var valCode = val.c || val.code, valName = val.n || val.name;\n          if (valCode === eiCode && valName === eiName) item = val;\n        }\n      }\n\n      if (!item) {\n        if (isString(val)) {\n          item = ac.searchInData(val, speicalData);\n          if (!item && !ac.params.forceSelect) item = {c: val, n: val};\n        } else if (ac.params.forceSelect) {\n          item = ac.searchInData(val, speicalData);\n        } else {\n          item = val;\n        }\n      }\n\n      if (!item) {\n        delete ac.editingItem;\n        return;\n      }\n\n      delete ac.editingItem;\n\n      if (item.optGroup === true) return false;\n\n      var badgeEl, itemName = item.n || item.name, customNameHtml = item.hn || item.htmlName;\n      if (ac.params.badgeRender) badgeEl = ac.params.badgeRender.call(ac, item);\n      else {\n        badgeEl = $(ac.params.tpls.badgeTpl);\n        var text = badgeEl.find('.badge-text');\n        if (ac.params.itemUseHtml) text.append(ohtml($(customNameHtml || itemName)));\n        else text.text(itemName);\n        text.attr('title', itemName);\n      }\n\n      badgeEl\n        .data('bsAutoCompleteItem', item)\n        .addClass(CLS.badgeCt + ' ' + ac.params.badgeCls)\n        .click(function (e) {\n          stopEvent(e);\n        });\n\n      // close handler\n      badgeEl.find('.badge-close').click(function (e) {\n        badge.closeBadge(badgeEl, {closePanel: !ac.isSelectOptionMode()});\n        stopEvent(e);\n      });\n\n      // text handler\n      badgeEl.find('.badge-text')[ac.params.dblclick4Edit ? 'dblclick' : 'click'](function (e) {\n        if (ac.isReadonly()) return;\n\n        badgeEl.after(ac.input.el).remove();\n        ac.removeSelected(item);\n\n        var text = ac.isInSearchMode('name') ? item.n || item.name : item.c || item.code;\n        if (ac.params.getText4BadgeEdit) text = ac.params.getText4BadgeEdit.call(ac, item, text);\n        ac.editingItem = {item: item, text: text};\n        ac.close();\n        ac.input.updateTextValue(text);\n        stopEvent(e);\n      });\n\n      var doAdd = false;\n      if (ac.params.filtSame && ac.selectedItems.length > 0 && !ac.isSingleMode()) {\n        var hasSame = ac.findSelectedItem(item) >= 0;\n        if (hasSame) return true;\n        else doAdd = true;\n      } else doAdd = true;\n\n      if (doAdd) {\n        if (ac.isSingleMode()) ac.el.children('.' + CLS.badgeCt).remove();\n        ac.input.el.before(badgeEl);\n        ac.addSelected(item, {fire: !speicalData, itemEl: opts.itemEl});\n        badge.resize(badgeEl);\n        if (ac.isSingleMode()) ac.input.updateTextValue(itemName, false);\n        ac.placeholder.refresh();\n      }\n      return doAdd;\n    };\n\n    if (ac.isSingleMode()) ac.el.addClass('single-badge');\n  };\n\n  // Input\n  var Input = function (ac) {\n    var input = this, inputCt = input.el = $(ac.params.tpls.inputTpl).appendTo(ac.el);\n    var inputSizer = inputCt.children('.input-delegate-sizer');\n\n    var loadTimeout, compositionFlag;\n    var inputEl = inputCt.children(':text');\n\n    var loadDataOnInput = ac.params.debounceFn(ac.params.inputSearchDelay, function () {\n      if (ac.destoried) return;\n\n      if (inputEl.val().length < ac.params.minChar) {\n        ac.close();\n        ac.panel.el.empty();\n        return;\n      }\n\n      ac.loadData({from: 'keydown'}).then(function () {\n        if (!ac.input.isFocused) return;\n        ac.open();\n        ac.panel.render();\n      });\n    }, true);\n\n    inputEl.on({\n      'focus'           : function (e) {\n        if (ac.isReadonly()) {\n          inputEl.blur();\n          stopEvent(e);\n          return;\n        }\n\n        input.isFocused = true;\n        input.updateSizer();\n        if (!ac.params.hideBadge) ac.placeholder.el.hide();\n        ac.el.addClass('focus');\n        if (ac.params.minChar <= 0 || inputEl.val().length >= ac.params.minChar) ac.openOnFocus();\n        if (ac.isSingleMode() && ac.getValue().length > 0) {\n          setCaretPosition(inputEl[0]);\n          ac.editingItem = {item: ac.getValue()[0], text: inputEl.val()};\n        }\n        ac.fireOnFocus();\n      },\n      'blur'            : function (e) {\n        if (!input.isFocused) return;\n        input.isFocused = false;\n        ac.el.removeClass('focus');\n\n        var preventBlur = false;\n        if (ac.isSelectOptionMode()) { // 下拉框模式，阻止点击关闭badge时失去焦点\n          var relatedTarget = e.relatedTarget;\n          if (relatedTarget) {\n            var blurByCloseBadgeEl = $(relatedTarget).closest('.badge-close');\n            if (blurByCloseBadgeEl.length > 0)\n              preventBlur = true;\n          }\n        }\n\n        if (!preventBlur && inputEl.val() && !input.beforeMoveVal || !inputEl.val() && ac.isSingleMode())\n          input.confirmValue(false, {fromBlur: true});\n        ac.placeholder.refresh();\n\n        if (!preventBlur) {\n          ac.close();\n          ac.fireOnBlur();\n        }\n      },\n      'keydown'         : function (e) {\n        if (ac.isReadonly()) return;\n\n        input.updateSizer();\n\n        var specialKey = false;\n        switch (e.keyCode) {\n          case KEY_CODES.ENTER:\n            // 防止用户输入自定义字符串后回车，此时自定义字符串的字典加载请求还在debounce或者异步请求中\n            // 回车操作后应该关闭组件面板，但因为上述异步行为可能导致面板再次展示出来\n            if (loadTimeout) {\n              clearTimeout(loadTimeout);\n              loadTimeout = undefined;\n            }\n\n            var itemEl = ac.panel.getSelectedItemEl();\n            var item = itemEl.data('bsAutoCompleteItem');\n\n            if (item) {\n              // var itemName = item.n || item.name, itemCode = item.c || item.code;\n              // if (ac.isInSearchMode('name') && itemName) inputEl.val(itemName);\n              // else if (itemCode) inputEl.val(itemCode);\n\n              var badgeEl = ac.isSelected(item) && ac.badge.findSelectedBadgeEl(item);\n              if (!!badgeEl) ac.badge.closeBadge(badgeEl, {closePanel: !ac.isSelectOptionMode(), itemEl: itemEl});\n              else ac.badge.addBadge(item, {itemEl: itemEl});\n            }\n\n            if (!ac.isSelectOptionMode()) input.blur();\n            else if (!item && inputEl.val() && !input.beforeMoveVal || !inputEl.val() && ac.isSingleMode()) {\n              input.confirmValue(false, {fromBlur: false});\n            }\n\n            stopEvent(e);\n            specialKey = true;\n            break;\n          case KEY_CODES.ESC:\n            input.confirmValue(true);\n            specialKey = true;\n            break;\n          case KEY_CODES.TAB:\n            var hasVal = !!inputEl.val();\n            input.confirmValue();\n            if (hasVal && !ac.isSingleMode()) {\n              inputEl.focus();\n              stopEvent(e);\n            }\n            specialKey = true;\n            break;\n          case KEY_CODES.LEFT:\n          case KEY_CODES.RIGHT:\n            var caretPos = getCaretPosition(inputEl[0]), textLen = inputEl.val().length;\n            if (e.keyCode === KEY_CODES.LEFT && caretPos === 0) {\n              input.moveToLR(true);\n              stopEvent(e);\n            } else if (e.keyCode === KEY_CODES.RIGHT && caretPos === textLen) {\n              input.moveToLR(false);\n              stopEvent(e);\n            }\n            specialKey = true;\n            break;\n          case KEY_CODES.UP:\n          case KEY_CODES.DOWN:\n            ac.panel.moveSelect(e.keyCode === KEY_CODES.UP);\n            stopEvent(e);\n            specialKey = true;\n            break;\n          case KEY_CODES.BACK:\n            if (!inputEl.val()) {\n              var prevBadge = inputCt.prev('.' + CLS.badgeCt);\n              if (prevBadge.size() > 0) {\n                ac.badge.closeBadge(prevBadge);\n                stopEvent(e);\n                specialKey = true;\n              }\n            }\n            break;\n          case KEY_CODES.DELETE:\n            if (!inputEl.val()) {\n              var nextBadge = inputCt.next('.' + CLS.badgeCt);\n              if (nextBadge.size() > 0) {\n                ac.badge.closeBadge(nextBadge);\n                stopEvent(e);\n                specialKey = true;\n              }\n            }\n            break;\n          default:\n            ac.panel.relocate();\n        }\n\n        if (!specialKey) {\n          if (loadTimeout) clearTimeout(loadTimeout);\n          loadTimeout = setTimeout(function () { // 由于是监听keydown事件，而最后实际输入的字符要keyup之后才能拿到，所以设置个延迟\n            loadTimeout = undefined;\n            if (!compositionFlag) loadDataOnInput();\n          }, 200);\n        }\n      },\n      'keyup'           : function (e) {\n        if (ac.isReadonly()) return;\n        input.updateSizer();\n        var text = inputEl.val();\n        if (!!text) inputCt.addClass(CLS.hasInputVal);\n        else inputCt.removeClass(CLS.hasInputVal);\n      },\n      'compositionstart': function () {\n        compositionFlag = true;\n        // console.log('输入法，录入开始');\n      },\n      'compositionend'  : function () {\n        compositionFlag = false;\n        loadDataOnInput(); //在input之后执行 所以需要手动调用一次\n        // console.log('输入法，输入结束');\n      },\n    });\n\n    // moveToLR\n    input.moveToLR = function (isLeft) {\n      if (ac.isSingleMode()) return;\n\n      var badge = isLeft ? inputCt.prev('.' + CLS.badgeCt + ' ') : inputCt.next('.' + CLS.badgeCt);\n      if (badge) {\n        input.beforeMoveVal = inputEl.val();\n        isLeft ? badge.before(inputCt) : badge.after(inputCt);\n        inputEl.val(input.beforeMoveVal);\n        input.focus();\n        delete input.beforeMoveVal;\n      }\n    };\n\n    // moveToBadge\n    input.moveToBadge = function (badge) {\n      if (ac.isSingleMode()) return;\n\n      if (badge) badge.before(input.el);\n      else {\n        var lastBadge = ac.badge.getLastBadge();\n        if (lastBadge) lastBadge.after(input.el);\n      }\n    };\n\n    // updateSizer\n    input.updateSizer = function () {\n      inputSizer.text(inputEl.val() + 'WW');\n    };\n\n    // updateTextValue\n    input.updateTextValue = function (text, focus) {\n      inputEl.val(text);\n      if (!input.isFocused && focus !== false) input.focus();\n      input.updateSizer();\n      if (isIE && focus !== false) setCaretPosition(inputEl[0]);\n    };\n\n    // confirmValue\n    input.confirmValue = function (isEsc, opts) {\n      opts = opts || {};\n      var added;\n\n      if (isEsc) {\n        if (ac.editingItem) added = ac.badge.addBadge(ac.editingItem.item);\n      } else added = ac.badge.addBadge(inputEl.val());\n\n      //if (isIE && ac.isSingleMode() && fromBlur) {\n      //  ac.close();\n      //  return;\n      //}\n\n      if (ac.isSingleMode()) {\n        if (!added) {\n          if (ac.selectedItems.length > 0) ac.removeSelected(ac.selectedItems[0]);\n          if (inputEl.val()) input.clear();\n        }\n        if (!opts.fromBlur) inputEl.blur();\n        ac.close();\n      } else if (inputEl.val()) {\n        input.clear();\n      }\n    };\n\n    // blur\n    input.blur = function () {\n      if (!input.isFocused) return;\n      inputEl.blur();\n    };\n\n    // clear\n    input.clear = function (fireBlur) {\n      inputEl.val('');\n      if (fireBlur === false) ac.placeholder.refresh();\n      else inputEl.blur();\n      inputSizer.text('W');\n      inputCt.removeClass(CLS.hasInputVal);\n    };\n\n    // getSearchText\n    input.getSearchText = function () {\n      return inputEl.val();\n    };\n\n    // focus\n    input.focus = function () {\n      if (input.isFocused) return;\n      inputEl.focus();\n    };\n\n    inputSizer.text('WW');\n    input.emptyWidth = getOuterWidth(inputCt);\n    inputSizer.text('W');\n\n    // hideBadge模式下，搜索框清理按钮\n    if (ac.params.hideBadge) {\n      $(ac.params.tpls.clearBtnTpl)\n        .addClass(CLS.inputClearBtnClass)\n        .appendTo(inputCt)\n        .mousedown(function (e) {\n          if (ac.isReadonly()) return;\n\n          ac.input.clear(false);\n          ac.loadData().then(function () {\n            ac.panel.render();\n          });\n          stopEvent(e);\n        });\n    }\n  };\n\n  // DropdownPanel\n  var DropdownPanel = function (ac) {\n    var panel = this, panelEl = panel.el = $(ac.params.tpls.dropdownTpl).appendTo(ac.el);\n    var emptyItemEl = $(ac.params.tpls.emptyDropDownItemTpl).text(ac.params.emptyListTip);\n\n    panelEl.on('mousewheel', function (e) {\n      if (e.currentTarget !== panelEl[0]) return;\n\n      var scrollTop = panelEl.scrollTop();\n      var innerHeight = panelEl.innerHeight();\n      var scrollHeight = panelEl[0].scrollHeight;\n      var delta = (e.originalEvent.wheelDelta && (e.originalEvent.wheelDelta > 0 ? 1 : -1)) ||\n        (e.originalEvent.detail && (e.originalEvent.detail > 0 ? -1 : 1));\n\n      if (scrollTop <= 0 && delta > 0 || // 到达顶部\n        scrollTop + innerHeight >= scrollHeight - 1 && delta < 0) { // 到达底部\n        stopEvent(e);\n      }\n    });\n\n    // findItemEl\n    panel.findItemEl = function (item) {\n      if (!item) return;\n\n      var foundItemEl;\n      var itemName = item.n || item.name, itemCode = item.c || item.code\n      var checkedItemEls = panelEl.children('li.' + CLS.dropdownItem + '.' + CLS.itemChecked);\n      $.each(checkedItemEls, function (i, itemEl) {\n        var $itemEl = $(itemEl);\n        var boundItem = $itemEl.data('bsAutoCompleteItem');\n        if (!boundItem) return;\n\n        if (boundItem === item) {\n          foundItemEl = $itemEl;\n          return false\n        }\n\n        var boundItemName = boundItem.n || boundItem.name, boundItemCode = boundItem.c || boundItem.code;\n        if (boundItemName === itemName && boundItemCode === itemCode) {\n          foundItemEl = $itemEl;\n        }\n      });\n      return foundItemEl;\n    };\n\n    // moveSelect\n    panel.moveSelect = function (isUp) {\n      var selItem = panelEl.children('li.' + CLS.dropdownItem + '.' + CLS.itemSelected), moveToItem,\n        itemCls = '.' + CLS.dropdownItem;\n      var skipMultiSel = !ac.isSingleMode() && ac.params.hideOtherSelected4Multiple;\n      if (skipMultiSel) itemCls += ':not(.' + CLS.multiHideSel + ')';\n      if (selItem.size() > 0) {\n        moveToItem = isUp ? selItem.prev() : selItem.next();\n\n        while (moveToItem.size() > 0) {\n          if (moveToItem.hasClass(CLS.dropdownItem) && (!skipMultiSel || !moveToItem.hasClass(CLS.multiHideSel)))\n            break;\n          moveToItem = isUp ? moveToItem.prev() : moveToItem.next();\n        }\n\n        if (moveToItem.size() <= 0) {\n          var items = panelEl.children(itemCls);\n          if (items.size() > 0) moveToItem = isUp ? $(items[items.size() - 1]) : $(items[0]);\n        }\n      } else {\n        var items = panelEl.children(itemCls);\n        if (items.size() > 0) moveToItem = isUp ? $(items[items.size() - 1]) : $(items[0]);\n      }\n\n      if (moveToItem && moveToItem.length > 0) {\n        selItem.removeClass(CLS.itemSelected);\n        moveToItem.addClass(CLS.itemSelected);\n        panel.scrollToSelected(moveToItem);\n      }\n    };\n\n    // scrollToSelected\n    panel.scrollToSelected = function (selectedItem) {\n      selectedItem = selectedItem || panelEl.children('li.' + CLS.dropdownItem + '.' + CLS.itemSelected);\n      if (selectedItem.size() > 0) {\n        var scrollTop = panelEl.scrollTop(), top = selectedItem.position().top + scrollTop;\n        top = top - (panelEl.height() - selectedItem.height()) / 2;\n        panelEl.scrollTop(top);\n      }\n    };\n\n    // getSelectedItemEl\n    panel.getSelectedItemEl = function () {\n      return panelEl.children('li.' + CLS.dropdownItem + '.' + CLS.itemSelected);\n    };\n\n    // initMenuBar\n    panel.initMenuBar = function () {\n      var menuBarEl = $(ac.params.tpls.dropdownTopBarTpl);\n      menuBarEl.find('.selrev-btn').mousedown(function (e) {\n        panelEl.children('.' + CLS.dropdownItem).each(function (i, itemEl) {\n          var $itemEl = $(itemEl);\n          var item = $itemEl.data('bsAutoCompleteItem');\n          if (!item) return;\n\n          var badgeEl = ac.isSelected(item) && ac.badge.findSelectedBadgeEl(item);\n          if (!!badgeEl) ac.badge.closeBadge(badgeEl, {closePanel: !ac.isSelectOptionMode(), itemEl: $itemEl});\n          else ac.badge.addBadge(item, {itemEl: $itemEl});\n        });\n        stopEvent(e);\n      });\n      menuBarEl.find('.selall-btn').mousedown(function (e) {\n        panelEl.children('.' + CLS.dropdownItem).each(function (i, itemEl) {\n          var $itemEl = $(itemEl);\n          var item = $itemEl.data('bsAutoCompleteItem');\n          if (!item) return;\n\n          var badgeEl = ac.isSelected(item) && ac.badge.findSelectedBadgeEl(item);\n          if (!badgeEl) ac.badge.addBadge(item, {itemEl: $itemEl});\n        });\n        stopEvent(e);\n      });\n      return menuBarEl;\n    };\n\n    // render\n    panel.render = function () {\n      var data = ac.data || [], searchText = ac.input.getSearchText();\n      panelEl.empty();\n      panelEl.scrollTop();\n\n      var ei = ac.editingItem && ac.editingItem.item || {}, eiCode = ei.c || ei.code, eiName = ei.n || ei.name;\n      if (data.length > 0) {\n        var matched = false, hasOptGroup;\n        var isMultiMode = !ac.isSingleMode(), hideOtherSelected4Multiple = ac.params.hideOtherSelected4Multiple;\n        var lastGroupEl, lastGroupChildCount = 0, selectableItemCount = 0;\n\n        panelEl.removeClass(CLS.emptyList);\n        if (ac.isSelectOptionMode() && !ac.isSingleMode()) {\n          var menuBarEl = panel.initMenuBar();\n          ac.el.addClass(CLS.modePrefix + MODE.selectOption.toLowerCase());\n          panelEl.append(menuBarEl);\n        } else {\n          ac.el.removeClass(CLS.modePrefix + MODE.selectOption.toLowerCase());\n        }\n\n        $.each(data, function (i, item) {\n          var itemEl, itemName = item.n || item.name, itemCode = item.c || item.code,\n            customNameHtml = item.hn || item.htmlName, selectable = true;\n          if (ac.params.itemRender) itemEl = ac.params.itemRender.call(ac, item, searchText);\n          else {\n            itemEl = $(ac.params.tpls.dropdownItemTpl);\n            var text = itemEl.find('.text');\n            if (ac.params.itemUseHtml) text.append(ohtml($(customNameHtml || itemName)));\n            else text.text(itemName);\n          }\n\n          var selectedItem = ac.selectedItemMap[itemCode];\n          var itemChecked = selectedItem && (\n            selectedItem === item ||\n            (selectedItem.c || selectedItem.code) === itemCode &&\n            (selectedItem.n || selectedItem.name) === itemName);\n\n          if (itemChecked) {\n            itemEl.addClass(CLS.itemChecked);\n            if (isMultiMode) {\n              itemEl.addClass(CLS.multiSelected);\n              if (hideOtherSelected4Multiple) {\n                selectable = false;\n                itemEl.addClass(CLS.multiHideSel);\n              }\n            }\n          } else {\n            itemEl.removeClass(CLS.itemChecked);\n          }\n\n          if (item.optGroup === true) {\n            selectable = false;\n            itemEl.addClass('bs-autocomplete-group');\n            if (!hasOptGroup) {\n              hasOptGroup = true;\n              panelEl.addClass('bs-autocomplete-grouped');\n            }\n\n            if (lastGroupEl && lastGroupChildCount <= 0)\n              lastGroupEl.addClass('bs-autocomplete-group-hide');\n\n            lastGroupEl = itemEl;\n            lastGroupChildCount = 0;\n          } else {\n            if (lastGroupEl && selectable) lastGroupChildCount++;\n            if (selectable) selectableItemCount++;\n            itemEl.addClass(CLS.dropdownItem);\n          }\n          if (item.cls) itemEl.addClass(item.cls);\n\n          itemEl\n            .appendTo(panelEl)\n            .data('bsAutoCompleteItem', item)\n            .attr('title', itemName)\n            .mousedown(function (e) {\n              if (ac.isReadonly()) return;\n              if (item.optGroup) {\n                stopEvent(e);\n                return;\n              }\n\n              var doAdd = true;\n              if (!ac.isSelectOptionMode()) {\n                if (isIE) ac.input.blur();\n                ac.input.clear();\n              } else {\n                if (ac.editingItem && ac.editingItem.item === item) {\n                  delete ac.editingItem;\n                  ac.removeSelected(item);\n\n                  if (ac.selectedItems.length <= 0) ac.input.blur();\n                  ac.placeholder.refresh();\n                  ac.fireBadgeRemoved();\n\n                  doAdd = false;\n                }\n\n                var badgeEl = ac.badge.findSelectedBadgeEl(item);\n                if (!!badgeEl) {\n                  ac.badge.closeBadge(badgeEl, {closePanel: false, itemEl: itemEl});\n                  doAdd = false;\n                }\n              }\n\n              if (doAdd) ac.badge.addBadge(item, {itemEl: itemEl});\n\n              stopEvent(e);\n            });\n\n          if (!matched && searchText) {\n            if (ac.editingItem && ac.editingItem.text == searchText) {\n              if (eiCode == itemCode && eiName == itemName)\n                matched = true;\n            }\n            if (ac.isInSearchMode('name') && searchText == itemName) {\n              matched = true;\n            } else if (ac.isInSearchMode('code') && searchText == itemCode) {\n              matched = true;\n            }\n            if (matched) itemEl.addClass(CLS.itemSelected);\n          }\n        });\n\n        if (lastGroupEl && lastGroupChildCount <= 0)\n          lastGroupEl.addClass('bs-autocomplete-group-hide');\n\n        if (selectableItemCount <= 0) {\n          panelEl.addClass('no-selectable-items');\n        } else {\n          panelEl.removeClass('no-selectable-items');\n        }\n      } else {\n        panelEl.addClass(CLS.emptyList).append(emptyItemEl);\n        if (!ac.isSelectOptionMode()) ac.close();\n      }\n    };\n\n    // resize\n    panel.resize = function () {\n      var width = ac.el.outerWidth();\n      panelEl.css('max-width', width);\n      if (ac.isSelectOptionMode()) panelEl.width(width);\n      if (ac.params.hideBadge) {\n        ac.input.el.width(width).css('max-width', width);\n      }\n      ac.fireOnPanelResize(ac);\n    };\n\n    // relocate\n    panel.relocate = function () {\n      var inputPosLeft = ac.input.el.position().left;\n      if (ac.isSingleMode() || ac.isSelectOptionMode()) inputPosLeft = 0;\n      panelEl.css('left', inputPosLeft + 'px');\n    };\n\n    // close\n    panel.close = function () {\n      panelEl.children('.' + CLS.dropdownItem)\n        .removeClass(CLS.itemSelected)\n        .removeClass(CLS.itemChecked);\n    };\n\n    // destroy\n    panel.destroy = function () {\n      panelEl.children().each(function () {\n        $(this).removeData('bsAutoCompleteItem');\n      });\n      panelEl.remove();\n    };\n  };\n\n  // AutoComplete\n  var AutoComplete = function (params, originEl) {\n    var ac = this;\n    params = $.extend(true, {tpls: TPLS}, params || {});\n    for (var def in DEF_OPTS) if (typeof params[def] === 'undefined') params[def] = DEF_OPTS[def];\n    ac.params = params, ac.initialized = false, ac.selectedItems = [], ac.selectedItemMap = {}, ac.readonly = false;\n\n    // htmlOverHandler\n    var htmlOverHandler = function () {\n      if (!ac.resized4htmlOver) {\n        if (ac.el.is(':visible')) ac.resize();\n        $('html').off('mouseover', htmlOverHandler);\n        ac.resized4htmlOver = true;\n      }\n    };\n\n    // htmlClickHandler\n    var htmlClickHandler = function (e) {\n      if (!ac.el.hasClass('open')) return;\n      if ($(e.target).hasClass('bootstrap-autocomplete')) return;\n\n      var autocomplete = $(e.target).parents('.bootstrap-autocomplete');\n      if (autocomplete.size() == 0) ac.close();\n      else if (autocomplete[0] != ac.el[0]) ac.close();\n    };\n\n    // htmlResizeHandler\n    var resizeTimeout;\n    var htmlResizeHandler = function (e) {\n      if (resizeTimeout) clearTimeout(resizeTimeout);\n      setTimeout(function () {\n        ac.panel.resize();\n      }, 100);\n    };\n\n    // elOverHandler\n    var elOverHandler = function () {\n      if (!ac.resized4elOver) {\n        if (ac.el.is(':visible')) ac.resize();\n        ac.el.off('mouseover', elOverHandler);\n        ac.resized4elOver = true;\n      }\n    };\n\n    // addValue\n    ac.addValue = function (items, opts) {\n      opts = $.extend({onSetFinish: $.noop}, opts || {});\n\n      var oldSelectedItems = ac.getValue(), changeFired;\n      if (opts.clear) ac.clearValue(false);\n      if (!items) {\n        opts.fireInit ? ac.fireOnInit() : changeFired = ac.fireOnChange(oldSelectedItems, ac.getValue());\n        opts.onSetFinish.call(ac, changeFired);\n        return;\n      }\n\n      if (!(items instanceof Array)) {\n        if (isString(items)) items = [{c: items, n: items}];\n        else items = [items];\n      } else if (items.length <= 0) {\n        return;\n      } else {\n        var formatedItems = [];\n        $.each(items, function (i, item) {\n          if (isString(item)) formatedItems.push({c: item, n: item});\n          else formatedItems.push(item);\n        });\n        items = formatedItems;\n      }\n\n      if (ac.params.forceSelect && ac.params.loadDataItems) {\n        ac.loadDataItems(items).then(function (tmpData) {\n          $.each(items, function (i, item) {\n            ac.badge.addBadge(item, {specialData: tmpData});\n          });\n        }).always(function () {\n          opts.fireInit ? ac.fireOnInit() : changeFired = ac.fireOnChange(oldSelectedItems, ac.getValue());\n          opts.onSetFinish.call(ac, changeFired);\n        });\n      } else {\n        var lastSearchData = ac.data, needCheckRemote = ac.params.forceSelect && ac.params.loadData && true;\n        var toCheckCount = items.length, checkedItemCount = 0;\n        if (items.length > 0 && !needCheckRemote) ac.data = (ac.params.data || []).slice();\n        $.each(items, function (i, item) {\n          if (needCheckRemote) {\n            if (ac.searchInData(item, lastSearchData)) {\n              ac.badge.addBadge(item);\n              checkedItemCount++;\n            } else {\n              var itemCode = item.c || item.code, itemName = item.n || item.name;\n              var searchMode = ac.isInSearchMode('name') ? 'name' : 'code';\n              var searchText = searchMode == 'code' ? itemCode : itemName, tmpData = [];\n              ac.loadData({\n                searchText                : searchText,\n                specialData               : tmpData,\n                showAllItemsWhenFirstFocus: false,\n                searchMode                : searchMode,\n                from                      : 'addValue'\n              }).then(function (tmpData) {\n                lastSearchData = tmpData;\n                ac.badge.addBadge(item, {specialData: tmpData});\n              }).always(function () {\n                if (++checkedItemCount == toCheckCount) {\n                  opts.fireInit ? ac.fireOnInit() : changeFired = ac.fireOnChange(oldSelectedItems, ac.getValue());\n                  opts.onSetFinish.call(ac, changeFired);\n                }\n              });\n            }\n          } else ac.badge.addBadge(item);\n        });\n        if (!needCheckRemote) {\n          opts.fireInit ? ac.fireOnInit() : changeFired = ac.fireOnChange(oldSelectedItems, ac.getValue());\n          opts.onSetFinish.call(ac, changeFired);\n        }\n      }\n    };\n\n    // setValue\n    ac.setValue = function (items, opts) {\n      opts = $.extend(opts || {}, {clear: true});\n      ac.addValue(items, opts);\n    };\n\n    // openOnFocus\n    ac.openOnFocus = function () {\n      var showAllItemsWhenFirstFocus = ac.params.showAllWhenSingleForceSelectFocus && ac.params.forceSelect && ac.isSingleMode();\n      ac.loadData({showAllItemsWhenFirstFocus: showAllItemsWhenFirstFocus, from: 'openOnFocus'}).then(function () {\n        ac.open();\n        ac.panel.render();\n      });\n    };\n\n    // isInSearchMode\n    ac.isInSearchMode = function (mode) {\n      return ac.params.searchMode.indexOf(mode) >= 0;\n    };\n\n    // resize\n    ac.resize = function () {\n      ac.badge.resize();\n    };\n\n    // destroy\n    ac.destroy = function () {\n      ac.destoried = true;\n      ac.panel.destroy();\n      $('html').off({'click': htmlClickHandler, 'mouseover': htmlOverHandler});\n      $(window).off('resize', htmlResizeHandler);\n      ac.params.el.removeData(\"bsAutoComplete\");\n      ac.el.remove();\n    };\n\n    // fireOnChange\n    ac.fireOnChange = function (oldItems, newItems) {\n      var fire = true;\n      if (oldItems != newItems && oldItems.length == newItems.length) {\n        var allItemsSame = true;\n        $.each(oldItems, function (i, oldItem) {\n          var oldItemCode = oldItem.code || oldItem.c, oldItemName = oldItem.name || oldItem.n;\n          var newItem = newItems[i], newItemCode = newItem.code || newItem.c, newItemName = newItem.name || newItem.n;\n          if (oldItemCode != newItemCode || oldItemName != newItemName) {\n            allItemsSame = false;\n            return false;\n          }\n        });\n        if (allItemsSame) fire = false;\n      }\n      if (fire) {\n        if (ac.params.disableResizeContainer !== false && ac.resizeContainer)\n          setTimeout(function () { ac.containerEl.height(ac.el.outerHeight()); }, 0);\n        ac.params.el.trigger('bs.autocomplete.change', [oldItems, newItems]);\n      }\n      return fire;\n    };\n\n    // fireOnPanelResize\n    ac.fireOnPanelResize = function () {\n      ac.params.el.trigger('bs.autocomplete.panel.resize', [ac]);\n    };\n\n    // fireOnSelect\n    ac.fireOnSelect = function (item, items) {\n      ac.params.el.trigger('bs.autocomplete.select', [item, items]);\n    };\n\n    // fireOnClose\n    ac.fireOnClose = function () {\n      if (ac.inputGroupEl) ac.inputGroupEl.removeClass('open');\n      ac.params.el.trigger('bs.autocomplete.close');\n    };\n\n    // fireOnInit\n    ac.fireOnInit = function () {\n      if (ac.isInitialized) return;\n\n      ac.isInitialized = true;\n      ac.params.el.trigger('bs.autocomplete.inited');\n    };\n\n    // fireOnFocus\n    ac.fireOnFocus = function () {\n      if (ac.inputGroupEl) ac.inputGroupEl.addClass('focus');\n      ac.params.el.trigger('bs.autocomplete.focus');\n    };\n\n    // fireOnPen\n    ac.fireOnPen = function () {\n      if (ac.inputGroupEl) ac.inputGroupEl.addClass('open');\n      ac.params.el.trigger('bs.autocomplete.open');\n    };\n\n    // fireBadgeRemoved\n    ac.fireBadgeRemoved = function () {\n      ac.params.el.trigger('bs.autocomplete.badge.removed');\n    };\n\n    // fireOnBlur\n    ac.fireOnBlur = function () {\n      if (ac.inputGroupEl) ac.inputGroupEl.removeClass('focus');\n      ac.params.el.trigger('bs.autocomplete.blur');\n    };\n\n    // fireOnDeSelect\n    ac.fireOnDeSelect = function (item, items) {\n      ac.params.el.trigger('bs.autocomplete.deselect', [item, items]);\n    };\n\n    // isSingleMode\n    ac.isSingleMode = function () {\n      return !ac.params.multiple;\n    };\n\n    // isSelectOptionMode\n    ac.isSelectOptionMode = function () {\n      return ac.params.mode === MODE.selectOption;\n    };\n\n    // close\n    ac.close = function () {\n      ac.el.removeClass('open');\n      ac.panel.close();\n      ac.fireOnClose();\n      ac.closeTime = new Date().getTime();\n    };\n\n    // open\n    ac.open = function () {\n      if (ac.readonly) return;\n      ac.panel.resize();\n      ac.panel.relocate();\n      ac.el.addClass('open');\n      ac.fireOnPen();\n    };\n\n    // isOpen\n    ac.isOpen = function () {\n      return ac.el.hasClass('open');\n    };\n\n    // getValue\n    ac.getValue = function () {\n      return ac.selectedItems.slice();\n    };\n\n    // clearData\n    ac.clearData = function () {\n      ac.data.splice(0, ac.data.length);\n    };\n\n    // clearValue\n    ac.clearValue = function (fire) {\n      if (ac.isSingleMode()) ac.input.clear(fire);\n\n      var oldSelectedItems = ac.getValue();\n      ac.selectedItems.splice(0, ac.selectedItems.length);\n      ac.selectedItemMap = {};\n      ac.el.children('.' + CLS.badgeCt).remove();\n      ac.el.removeClass(CLS.itemSelected);\n      if (ac.params.hideBadge) ac.renderSelectedItemsInfo();\n      ac.placeholder.refresh();\n      if (fire !== false) {\n        ac.params.el.trigger('bs.autocomplete.clear');\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    // setReadonly\n    ac.setReadonly = function (readonly) {\n      readonly = readonly !== false;\n      ac.readonly = readonly;\n      if (readonly) ac.el.addClass('readonly');\n      else ac.el.removeClass('readonly');\n    };\n\n    // isReadonly\n    ac.isReadonly = function () {\n      return ac.readonly;\n    };\n\n    // addSelected\n    ac.addSelected = function (item, opts) {\n      opts = opts || {};\n      var oldSelectedItems = ac.selectedItems.slice();\n\n      if (ac.isSingleMode()) {\n        ac.selectedItems.splice(0, ac.selectedItems.length);\n        ac.selectedItemMap = {};\n      }\n\n      ac.selectedItems.push(item);\n      ac.selectedItemMap[item.c || item.code] = item;\n      if (ac.selectedItems.length > 0) ac.el.addClass(CLS.itemSelected);\n\n      if (ac.isOpen()) {\n        var itemEl = opts.itemEl || ac.panel.findItemEl(item);\n        if (itemEl) itemEl.addClass(CLS.itemChecked);\n      }\n\n      if (ac.params.hideBadge) ac.renderSelectedItemsInfo();\n\n      if (opts.fire !== false) {\n        ac.fireOnSelect(item, ac.getValue());\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    // isSelected\n    ac.isSelected = function (item) {\n      return item && ac.selectedItemMap[item.c || item.code];\n    };\n\n    // removeSelected\n    ac.removeSelected = function (item) {\n      var findIndex = ac.findSelectedItem(item);\n      if (findIndex >= 0) {\n        var oldSelectedItems = ac.selectedItems.slice();\n        ac.selectedItems.splice(findIndex, 1);\n        delete ac.selectedItemMap[item.c || item.code];\n        if (ac.selectedItems.length <= 0) ac.el.removeClass(CLS.itemSelected);\n\n        if (ac.params.hideBadge) ac.renderSelectedItemsInfo();\n\n        ac.fireOnDeSelect(item, ac.getValue());\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    ac.renderSelectedItemsInfo = function () {\n      var selectedItems = ac.selectedItems || [];\n      var itemNames = [];\n      $.each(selectedItems, function (i, item) {\n        itemNames.push(item.n || item.name);\n      });\n\n      var selectedItemsInfoEl = ac.el.children('.selected-items-info');\n      // var maxWidth = getInnerWidth(ac.el) - ac.input.emptyWidth - 2;\n      selectedItemsInfoEl\n        // .css({maxWidth: maxWidth})\n        .text(itemNames.join(','));\n      ac.placeholder.refresh();\n    };\n\n    // isItemMatched\n    ac.isItemMatched = function (searchText, item) {\n      var regex = new RegExp(escapeRegex(searchText), ac.params.ignoreCase ? 'i' : undefined);\n      var matched = false;\n      if (ac.isInSearchMode('name')) matched = regex.test(item.n || item.name);\n      if (!matched && ac.isInSearchMode('code')) matched = regex.test(item.c || item.code);\n      return matched;\n    };\n\n    // findSelectedItem\n    ac.findSelectedItem = function (item) {\n      var result = -1, itemCode = item.c || item.code, itemName = item.n || item.name;\n      $.each(ac.selectedItems, function (i, selItem) {\n        var selCode = selItem.c || selItem.code, selName = selItem.n || selItem.name;\n        if (selCode === itemCode && selName === itemName) {\n          result = i;\n          return false;\n        }\n      });\n      return result;\n    };\n\n    // searchInData\n    ac.searchInData = function (item, data) {\n      var isFromStr = isString(item);\n      if (isFromStr) item = {c: item, n: item};\n      var findItem, itemCode = item.c || item.code, itemName = item.n || item.name, data = data || ac.data;\n\n      $.each(data, function (i, dataItem) {\n        var dataCode = dataItem.c || dataItem.code, dataName = dataItem.n || dataItem.name;\n        if (isFromStr) {\n          if (ac.isInSearchMode('name') && dataName == itemName || ac.isInSearchMode('code') && dataCode == itemCode) {\n            findItem = dataItem;\n            return false;\n          }\n        } else {\n          if (dataName == itemName && dataCode == itemCode) {\n            findItem = dataItem;\n            return false;\n          }\n        }\n      });\n      return findItem;\n    };\n\n    // loadDataItems\n    ac.loadDataItems = function (items) {\n      var defered = $.Deferred();\n      var loadedItems = [];\n\n      ac.params.loadDataItems.call(ac, items, function (data) {\n        if (data) {\n          $.each(data, function (i, item) {\n            if (isString(item)) item = {c: item, n: item};\n            loadedItems.push(item);\n          });\n          defered.resolve(loadedItems);\n        } else defered.reject();\n      });\n\n      return defered.promise();\n    };\n\n    // loadData\n    ac.loadDataSeq = 0;\n    ac.loadData = function (opts) {\n      var loadSeq = ac.loadDataSeq++;\n      opts = opts || {};\n      opts.searchText = opts.showAllItemsWhenFirstFocus ? '' : (opts.searchText || ac.input.getSearchText());\n      var defered = $.Deferred();\n\n      opts.specialData = opts.specialData || ac.data;\n      opts.specialData.splice(0, opts.specialData.length);\n      if (ac.params.loadData) {\n        ac.params.loadData.call(ac, opts.searchText, function (data, _loadSeq) {\n          // 通过seq跳过队列前端的异步响应\n          var nLoadSeq = Number(_loadSeq);\n          if (!isNaN(_loadSeq) && (_loadSeq + '' === nLoadSeq + '') && _loadSeq !== ac.loadDataSeq - 1) return;\n\n          if (data) {\n            opts.specialData.splice(0, opts.specialData.length);\n            $.each(data, function (i, item) {\n              if (isString(item)) item = {c: item, n: item};\n              opts.specialData.push(item);\n            });\n            defered.resolve(opts.specialData);\n          } else defered.reject();\n        }, opts.searchMode, opts.from, loadSeq);\n      } else {\n        var data = ac.params.data || [], lastGroupItem;\n        $.each(data, function (i, item) {\n          if (isString(item)) item = {c: item, n: item};\n          if (item.optGroup === true) {\n            lastGroupItem = item;\n            return;\n          }\n          if (opts.searchText && !ac.isItemMatched(opts.searchText, item)) return;\n          if (lastGroupItem) {\n            opts.specialData.push(lastGroupItem);\n            lastGroupItem = undefined;\n          }\n          opts.specialData.push(item);\n        });\n        defered.resolve(opts.specialData);\n      }\n      return defered.promise();\n    };\n\n    ac.data = [], ac.el = $(ac.params.tpls.containerTpl).addClass(ac.params.cls);\n\n    // 解决在 input-group 中的样式问题\n    var inputGroupEl = ac.inputGroupEl = params.el.closest('.input-group'),\n      isUnderInputGroup = ac.isUnderInputGroup = inputGroupEl.size() > 0;\n\n    var isOriginInputEl = params.el.is(':input');\n    if (isOriginInputEl && !ac.params.replace) ac.params.replace = true;\n\n    // 原始元素为 input 时且父元素为 input-group 时放入代理容器\n    var inputDelegateCtEl;\n    if (isOriginInputEl && params.el.parent().hasClass('input-group')) {\n      inputDelegateCtEl = ac.inputDelegateCtEl = $(ac.params.tpls.inputDelegateContainerTpl)\n        .addClass('form-control');\n      inputDelegateCtEl.insertAfter(params.el);\n      params.el.appendTo(inputDelegateCtEl);\n    }\n\n    if (ac.params.fitWdith !== false) ac.el.addClass('fit-width');\n    if (ac.params.dropUp) ac.el.addClass('dropup');\n    if (ac.params.replace) {\n      ac.el.insertAfter(params.el);\n      params.el.hide();\n    } else {\n      if (inputDelegateCtEl) {\n        ac.el.appendTo(inputDelegateCtEl);\n      } else {\n        if (isUnderInputGroup) params.el.addClass('form-control');\n        ac.el.appendTo(params.el);\n      }\n    }\n\n    var bsAcCtEl = ac.containerEl = ac.el.parent(), resizeHeightCls = 'bs-ac-ct-resize';\n    if (isUnderInputGroup && bsAcCtEl.hasClass('form-control')) bsAcCtEl.addClass(resizeHeightCls);\n    ac.resizeContainer = bsAcCtEl.hasClass(resizeHeightCls);\n\n    ac.input = new Input(ac);\n    ac.panel = new DropdownPanel(ac);\n    ac.badge = new Badge(ac);\n    ac.placeholder = new PlaceHolder(ac);\n    if (ac.params.data) {\n      $.each(ac.params.data, function (i, item) {\n        if (isString(item)) ac.data.push({c: item, n: item});\n        else ac.data.push(item);\n      });\n      ac.params.data = ac.data.slice();\n    }\n\n    { // clear btn\n      $(ac.params.tpls.clearBtnTpl)[ac.params.hideBadge ? 'prependTo' : 'appendTo'](ac.el)\n        .addClass(CLS.clearBtnClass)\n        .click(function (e) {\n          if (ac.isReadonly()) return;\n\n          ac.clearValue();\n          stopEvent(e);\n        });\n    }\n\n    if (ac.params.readonly) ac.setReadonly(true);\n\n    ac.el.on({\n      mousedown: function (e) {\n        if (ac.isReadonly()) return;\n\n        if (e.target == ac.el[0]) {\n          var badge = ac.badge.getCloestBadge(e.offsetX, e.offsetY);\n          ac.input.moveToBadge(badge);\n          if (ac.input.isFocused) stopEvent(e);\n          //ac.input.focus();\n        }\n      },\n      click    : function (e) {\n        if (ac.isReadonly()) return;\n        if (ac.params.hideBadge) ac.el.addClass('focus');\n        ac.input.focus();\n        if (ac.input.isFocused) stopEvent(e);\n      },\n      mouseover: elOverHandler\n    });\n\n    if (ac.params.hideBadge) {\n      ac.el.addClass(CLS.badgeHide);\n    } else {\n      ac.el.removeClass(CLS.badgeHide);\n    }\n\n    originEl.data(\"bsAutoComplete\", this);\n    if (ac.params.value) ac.setValue(ac.params.value, {fireInit: true});\n    else ac.fireOnInit();\n\n    $('html').on({'click': htmlClickHandler, 'mouseover': htmlOverHandler});\n    $(window).on('resize', htmlResizeHandler);\n  };\n\n  $.fn.bsAutoComplete = function (params) {\n    var args = arguments;\n    return this.each(function () {\n      if (!this) return;\n      var $this = $(this);\n\n      var bsAutoComplete = $this.data(\"bsAutoComplete\");\n      if (!bsAutoComplete && params != 'destroy') {\n        params = $.extend({\n          el: $this, value: $this.val() ? $this.val().split(params.splitChar || ' ') : ''\n        }, params);\n        bsAutoComplete = new AutoComplete(params, $this);\n      }\n      if (bsAutoComplete && isString(params))\n        bsAutoComplete[params].apply(bsAutoComplete, Array.prototype.slice.call(args, 1));\n    });\n  }\n\n})(jQuery);\n"]}