{"version":3,"sources":["js/bootstrap-autocomplete.js"],"names":["$","DEF_OPTS","cls","placeHolder","searchMode","ignoreCase","fitWdith","dropUp","filtSame","badgeCls","dblclick4Edit","inputSearchDelay","forceSelect","minChar","multiple","debounceFn","delay","fn","atBegin","debounce","mockDebounceTimeout","lastTimeoutId","now","Date","getTime","clearTimeout","setTimeout","isIE","navigator","userAgent","indexOf","KEY_CODES","TPLS","inputDelegateContainerTpl","containerTpl","inputTpl","dropdownTpl","placeholderTpl","clearBtnTpl","dropdownItemTpl","badgeTpl","CLS","getCssNum","el","css","Number","replace","ohtml","e","append","html","setCaretPosition","oField","document","selection","createRange","moveStart","value","length","selectionStart","stopEvent","preventDefault","stopPropagation","isString","val","PlaceHolder","ac","placeholderEl","this","params","tpls","prependTo","text","refresh","selectedItems","hide","show","Badge","badge","resize","closeEl","find","badgeMarginL","badgeMarginR","maxWidth","padL","padR","innerWidth","input","emptyWidth","outerWidth","children","each","closeBadge","badgeEl","click","getLastBadge","badges","size","getCloestBadge","mouseX","mouseY","cloestBadgeEl","isLineMatched","pos","position","left","top","bottom","outerHeight","add","speicalData","item","panel","getSelectedItem","editingItem","ei","eiCode","c","code","eiName","n","name","valCode","valName","findItem","searchInData","itemName","customNameHtml","hn","htmlName","badgeRender","call","itemUseHtml","attr","addClass","isReadonly","remove","removeSelected","blur","close","placeholder","fireBadgeRemoved","after","isInSearchMode","getText4BadgeEdit","updateTextValue","doAdd","isSingleMode","findSelectedItem","before","addSelected","Input","loadTimeout","compositionFlag","inputCt","appendTo","inputSizer","inputEl","loadDataOnInput","destoried","empty","loadData","from","then","open","render","on","focus","isFocused","updateSizer","openOnFocus","getValue","fireOnFocus","removeClass","beforeMoveVal","confirmValue","fireOnBlur","keydown","specialKey","keyCode","itemCode","hasVal","caretPos","oSel","getCaretPosition","textLen","moveToLR","moveSelect","prevBadge","prev","nextBadge","next","relocate","undefined","keyup","compositionstart","compositionend","isLeft","moveToBadge","lastBadge","isEsc","fromBlur","added","clear","fireBlur","getSearchText","DropdownPanel","panelEl","isUp","moveToItem","selItem","itemCls","skipMultiSel","hideOtherSelected4Multiple","hasClass","items","scrollToSelected","selectedItem","scrollTop","height","data","searchText","hasOptGroup","lastGroupEl","matched","isMultiMode","lastGroupChildCount","selectableItemCount","i","itemEl","selectable","itemRender","selectedItemMap","optGroup","mousedown","width","fireOnPanelResize","inputPosLeft","destroy","removeData","AutoComplete","originEl","def","extend","initialized","readonly","htmlOverHandler","resized4htmlOver","is","off","htmlClickHandler","target","autocomplete","parents","htmlResizeHandler","elOverHandler","resized4elOver","addValue","opts","onSetFinish","noop","changeFired","oldSelectedItems","clearValue","fireInit","fireOnInit","fireOnChange","Array","formatedItems","push","loadDataItems","tmpData","always","lastSearchData","needCheckRemote","toCheckCount","checkedItemCount","slice","specialData","showAllItemsWhenFirstFocus","setValue","showAllWhenSingleForceSelectFocus","mode","mouseover","window","oldItems","newItems","fire","allItemsSame","oldItem","oldItemCode","oldItemName","newItem","newItemCode","newItemName","disableResizeContainer","resizeContainer","containerEl","trigger","fireOnSelect","fireOnClose","inputGroupEl","isInitialized","fireOnPen","fireOnDeSelect","clearData","splice","setReadonly","findIndex","isItemMatched","regex","RegExp","str","escapeRegex","test","result","selCode","selName","isFromStr","dataItem","dataCode","dataName","defered","Deferred","loadedItems","resolve","reject","promise","lastGroupItem","inputDelegateCtEl","closest","isUnderInputGroup","isOriginInputEl","parent","insertAfter","bsAcCtEl","resizeHeightCls","offsetX","offsetY","bsAutoComplete","args","arguments","$this","split","splitChar","apply","prototype","jQuery"],"mappings":"CAAA,SAAWA,GACT,aAGA,IAAIC,EAAW,CACbC,IAAkB,GAClBC,YAAkB,MAClBC,WAAkB,YAClBC,YAAkB,EAClBC,UAAkB,EAClBC,QAAkB,EAClBC,UAAkB,EAClBC,SAAkB,GAClBC,eAAkB,EAClBC,iBAAkB,IAClBC,aAAkB,EAClBC,QAAkB,EAClBC,UAAkB,EAClBC,WAAkB,SAAUC,EAAOC,EAAIC,GACrC,GAAIlB,EAAEmB,SAAU,OAAOnB,EAAEmB,SAASH,EAAOE,EAASD,GAEhD,IAAIG,GAAuB,EAAGC,GAAiB,EAC/C,OAAO,WACL,IAAIC,IAAO,IAAIC,MAAOC,WAClBJ,EAAsB,GAAmCJ,EAA7BM,EAAMF,KACpCA,EAAsBE,EAEF,EAAhBD,IACFI,aAAaJ,GACbA,GAAiB,GAGnBA,EAAgBK,WAAW,WAEzBN,EADAC,GAAiB,EAEjBJ,KACCD,OAOTW,GAAiD,EAA1CC,UAAUC,UAAUC,QAAQ,WAGnCC,EACK,GADLA,EACc,EADdA,EACuB,GADvBA,EAC+B,GAD/BA,EAC0C,GAD1CA,EACoD,GADpDA,EAC6D,GAD7DA,EACuE,EADvEA,EACkF,GAIlFC,EAAO,CACTC,0BAA2B,wCAC3BC,aAA2B,oEAC3BC,SAA2B,gJAI3BC,YAA2B,uDAC3BC,eAA2B,kDAC3BC,YAA2B,0FAC3BC,gBAA2B,gGAK3BC,SAA2B,+JAOzBC,EACa,wBADbA,EAEa,uBAFbA,EAGa,oBAHbA,EAIa,yBAmCbC,EAAY,SAAUC,EAAIC,GAC5B,OAAOC,OAAOF,EAAGC,IAAIA,GAAKE,QAAQ,KAAM,MAItCC,EAAQ,SAAUC,GACpB,OAAOhD,EAAE,eAAeiD,OAAOD,GAAGE,QAIhCC,EAAmB,SAAUC,GAC3BC,SAASC,UACAD,SAASC,UAAUC,cACzBC,UAAU,YAAaJ,EAAOK,MAAMC,QAEzCN,EAAOO,eAAiBP,EAAOK,MAAMC,QAKrCE,EAAY,SAAUZ,GACxBA,EAAEa,iBACFb,EAAEc,mBAIAC,EAAW,SAAUC,GACvB,MAAsB,iBAARA,GAIZC,EAAc,SAAUC,GAC1B,IAAwBC,EAANC,KAAkCzB,GAAK3C,EAAEkE,EAAGG,OAAOC,KAAKjC,gBAAgBkC,UAAUL,EAAGvB,IACvGwB,EAAcK,KAAKN,EAAGG,OAAOlE,aADXiE,KAGNK,QAAU,WACU,EAA1BP,EAAGQ,cAAchB,OAAYS,EAAcQ,OAC1CR,EAAcS,SAKnBC,EAAQ,SAAUX,GACpB,IAAIY,EAAQV,KAGZU,EAAMC,OAAS,SAAUpC,GACvB,GAAIA,EAAI,CACN,IAAIqC,EAAUrC,EAAGsC,KAAK,gBAClBC,EAAexC,EAAUC,EAAI,eAAgBwC,EAAezC,EAAUC,EAAI,gBAC1EyC,GA1EoBzC,EA0EKuB,EAAGvB,GAzEhC0C,EAAO3C,EAAUC,EAAI,gBAAiB2C,EAAO5C,EAAUC,EAAI,iBACxDA,EAAG4C,aAAeF,EAAOC,EAwEUpB,EAAGsB,MAAMC,WAAaP,EAAeC,EAAeH,EAAQU,aAAe,GACjH/C,EAAGsC,KAAK,eAAerC,IAAI,YAAawC,EAAW,WAEnDlB,EAAGvB,GAAGgD,SAAS,IAAMlD,GAAamD,KAAK,WACrCd,EAAMC,OAAO/E,EAAEoE,SA9EH,IAAUzB,EACxB0C,EAAsCC,GAmF1CR,EAAMe,WAAa,SAAUC,GAC3BA,EAAQb,KAAK,gBAAgBc,SAI/BjB,EAAMkB,aAAe,WACnB,IAAIC,EAAS/B,EAAGvB,GAAGgD,SAAS,IAAMlD,GAClC,GAAoB,EAAhBwD,EAAOC,OAAY,OAAOlG,EAAEiG,EAAOA,EAAOC,OAAS,KAIzDpB,EAAMqB,eAAiB,SAAUC,EAAQC,GACvC,IAAIC,EAAeC,EAgBnB,OAfArC,EAAGvB,GAAGgD,SAAS,IAAMlD,GAAamD,KAAK,WACrC,IAAIE,EAAU9F,EAAEoE,MAAOoC,EAAMV,EAAQW,WACjCC,EAAOF,EAAIE,KAAMC,EAAMH,EAAIG,IAAKC,EAASD,EAAMb,EAAQe,cACjDL,EAAIE,KAAOZ,EAAQJ,aAC7B,GAAciB,GAAVN,GAAiBA,GAAUO,GAE7B,GADAL,GAAgB,EACZH,GAAUM,EAEZ,OADAJ,EAAgBR,GACT,OAEJ,GAAIS,EAET,OADAD,EAAgBR,GACT,IAGJQ,GAITxB,EAAMgC,IAAM,SAAU9C,EAAK+C,GACzB,IAAIC,EAAO9C,EAAG+C,MAAMC,kBACpB,IAAKF,EAAM,CACT,IAAKhD,EAEH,mBADOE,EAAGiD,YAIZ,GAAIjD,EAAGiD,YACL,GAAInD,IAAQE,EAAGiD,YAAYH,KAAMA,EAAOhD,OACnC,GAAID,EAASC,GACZE,EAAGiD,YAAY3C,MAAQR,IAAKgD,EAAO9C,EAAGiD,YAAYH,UACjD,CACL,IAAII,EAAKlD,EAAGiD,YAAYH,KAAMK,EAASD,EAAGE,GAAKF,EAAGG,KAAMC,EAASJ,EAAGK,GAAKL,EAAGM,KACxEC,EAAUP,EAAGE,GAAKF,EAAGG,KAAMK,EAAUR,EAAGK,GAAKL,EAAGM,KAChDC,GAAWN,GAAUO,GAAWJ,IAAQR,EAAOhD,GAKrD,IAAI6D,EADN,IAAKb,EAECjD,EAASC,IACX6D,EAAW3D,EAAG4D,aAAa9D,EAAK+C,KACd7C,EAAGG,OAAOzD,cAAaoG,EAAO,CAACM,EAAGtD,EAAKyD,EAAGzD,IAExDE,EAAGG,OAAOzD,aACZiH,EAAW3D,EAAG4D,aAAa9D,EAAK+C,MAClBC,EAAOa,GAChBb,EAAOhD,EAIlB,IAAKgD,EAEH,mBADO9C,EAAGiD,mBAIPjD,EAAGiD,YAEV,IAAIrB,EAASiC,EAAWf,EAAKS,GAAKT,EAAKU,KAAMM,EAAiBhB,EAAKiB,IAAMjB,EAAKkB,SAC9E,GAAIhE,EAAGG,OAAO8D,YAAarC,EAAU5B,EAAGG,OAAO8D,YAAYC,KAAKlE,EAAI8C,OAC/D,CAEH,IAAIxC,GADJsB,EAAU9F,EAAEkE,EAAGG,OAAOC,KAAK9B,WACRyC,KAAK,eACpBf,EAAGG,OAAOgE,YAAa7D,EAAKvB,OAAOF,EAAM/C,EAAEgI,GAAkBD,KAC5DvD,EAAKA,KAAKuD,GACfvD,EAAK8D,KAAK,QAASP,GAGrBjC,EAAQyC,SAAS9F,EAAc,IAAMyB,EAAGG,OAAO5D,UAAUsF,MAAM,SAAU/C,GACvEY,EAAUZ,KAIZ8C,EAAQb,KAAK,gBAAgBc,MAAM,SAAU/C,GACvCkB,EAAGsE,eACP1C,EAAQ2C,SACRvE,EAAGwE,eAAe1B,GAEd9C,EAAGQ,cAAchB,QAAU,GAAGQ,EAAGsB,MAAMmD,OAC3CzE,EAAG0E,QACH1E,EAAG2E,YAAYpE,UACfP,EAAG4E,mBACHlF,EAAUZ,MAIZ8C,EAAQb,KAAK,eAAef,EAAGG,OAAO3D,cAAgB,WAAa,SAAS,SAAUsC,GACpF,IAAIkB,EAAGsE,aAAP,CAEA1C,EAAQiD,MAAM7E,EAAGsB,MAAM7C,IAAI8F,SAC3BvE,EAAGwE,eAAe1B,GAElB,IAAIxC,EAAON,EAAG8E,eAAe,QAAUhC,EAAKS,GAAKT,EAAKU,KAAOV,EAAKM,GAAKN,EAAKO,KACxErD,EAAGG,OAAO4E,oBAAmBzE,EAAON,EAAGG,OAAO4E,kBAAkBb,KAAKlE,EAAI8C,EAAMxC,IACnFN,EAAGiD,YAAc,CAACH,KAAMA,EAAMxC,KAAMA,GACpCN,EAAG0E,QACH1E,EAAGsB,MAAM0D,gBAAgB1E,GACzBZ,EAAUZ,MAGZ,IAAImG,GAAQ,EACZ,GAAIjF,EAAGG,OAAO7D,UAAsC,EAA1B0D,EAAGQ,cAAchB,SAAeQ,EAAGkF,eAAgB,CAE3E,GAD2C,GAA7BlF,EAAGmF,iBAAiBrC,GACrB,OAAO,EACfmC,GAAQ,OACRA,GAAQ,EAUf,OARIA,IACEjF,EAAGkF,gBAAgBlF,EAAGvB,GAAGgD,SAAS,IAAMlD,GAAagG,SACzDvE,EAAGsB,MAAM7C,GAAG2G,OAAOxD,GACnB5B,EAAGqF,YAAYvC,GAAOD,GACtBjC,EAAMC,OAAOe,GACT5B,EAAGkF,gBAAgBlF,EAAGsB,MAAM0D,gBAAgBnB,GAAU,GAC1D7D,EAAG2E,YAAYpE,WAEV0E,GAGLjF,EAAGkF,gBAAgBlF,EAAGvB,GAAG4F,SAAS,iBAIpCiB,EAAQ,SAAUtF,GACpB,IAGIuF,EAAaC,EAzNW/G,EAsNxB6C,EAAQpB,KAAMuF,EAAUnE,EAAM7C,GAAK3C,EAAEkE,EAAGG,OAAOC,KAAKnC,UAAUyH,SAAS1F,EAAGvB,IAC1EkH,EAAaF,EAAQhE,SAAS,yBAG9BmE,EAAUH,EAAQhE,SAAS,SAE3BoE,EAAkB7F,EAAGG,OAAOtD,WAAWmD,EAAGG,OAAO1D,iBAAkB,WACrE,IAAIuD,EAAG8F,UAEP,OAAIF,EAAQ9F,MAAMN,OAASQ,EAAGG,OAAOxD,SACnCqD,EAAG0E,aACH1E,EAAG+C,MAAMtE,GAAGsH,cAId/F,EAAGgG,SAAS,CAACC,KAAM,YAAYC,KAAK,WAClClG,EAAGmG,OACHnG,EAAG+C,MAAMqD,aAEV,GAEHR,EAAQS,GAAG,CACTC,MAAoB,SAAUxH,GAC5B,GAAIkB,EAAGsE,aAGL,OAFAsB,EAAQnB,YACR/E,EAAUZ,GAIZwC,EAAMiF,WAAY,EAClBjF,EAAMkF,cACNxG,EAAG2E,YAAYlG,GAAGgC,OAClBT,EAAGvB,GAAG4F,SAAS,UACXrE,EAAGG,OAAOxD,SAAW,GAAKiJ,EAAQ9F,MAAMN,QAAUQ,EAAGG,OAAOxD,UAASqD,EAAGyG,cACxEzG,EAAGkF,gBAAyC,EAAvBlF,EAAG0G,WAAWlH,SACrCP,EAAiB2G,EAAQ,IACzB5F,EAAGiD,YAAc,CAACH,KAAM9C,EAAG0G,WAAW,GAAIpG,KAAMsF,EAAQ9F,QAE1DE,EAAG2G,eAELlC,KAAoB,WACbnD,EAAMiF,YACXjF,EAAMiF,WAAY,EAClBvG,EAAGvB,GAAGmI,YAAY,UAEdhB,EAAQ9F,QAAUwB,EAAMuF,gBAAkBjB,EAAQ9F,OAASE,EAAGkF,iBAChE5D,EAAMwF,cAAa,GAAO,GAC5B9G,EAAG2E,YAAYpE,UACfP,EAAG0E,QACH1E,EAAG+G,eAELC,QAAoB,SAAUlI,GAC5B,IAAIkB,EAAGsE,aAAP,CAEAhD,EAAMkF,cAEN,IAAIS,GAAa,EACjB,OAAQnI,EAAEoI,SACR,KAAKrJ,EACH,IAAIiF,EAAO9C,EAAG+C,MAAMC,kBACpB,GAAIF,EAAM,CACR,IAAIe,EAAWf,EAAKS,GAAKT,EAAKU,KAAM2D,EAAWrE,EAAKM,GAAKN,EAAKO,KAC1DrD,EAAG8E,eAAe,SAAWjB,EAAU+B,EAAQ9F,IAAI+D,GAC9CsD,GAAUvB,EAAQ9F,IAAIqH,GAEjC7F,EAAMmD,OACN/E,EAAUZ,GACVmI,GAAa,EACb,MACF,KAAKpJ,EACHyD,EAAMwF,cAAa,GACnBG,GAAa,EACb,MACF,KAAKpJ,EACH,IAAIuJ,IAAWxB,EAAQ9F,MACvBwB,EAAMwF,eACFM,IAAWpH,EAAGkF,iBAChBU,EAAQU,QACR5G,EAAUZ,IAEZmI,GAAa,EACb,MACF,KAAKpJ,EACL,KAAKA,EACH,IAAIwJ,EArSS,SAAUnI,GAC/B,IAAImI,EAAW,EACf,GAAIlI,SAASC,UAAW,CACtB,IAAIkI,EAAOnI,SAASC,UAAUC,cAC9BiI,EAAKhI,UAAU,YAAa,EAAIJ,EAAOK,MAAMC,QAC7C6H,EAAWC,EAAKhH,KAAKd,YACZN,EAAOO,gBAA2C,KAAzBP,EAAOO,kBACzC4H,EAAWnI,EAAOO,gBAEpB,OAAO4H,EA4RgBE,CAAiB3B,EAAQ,IAAK4B,EAAU5B,EAAQ9F,MAAMN,OACjEV,EAAEoI,SAAWrJ,GAA8B,GAAZwJ,GACjC/F,EAAMmG,UAAS,GACf/H,EAAUZ,IACDA,EAAEoI,SAAWrJ,GAAmBwJ,GAAYG,IACrDlG,EAAMmG,UAAS,GACf/H,EAAUZ,IAEZmI,GAAa,EACb,MACF,KAAKpJ,EACL,KAAKA,EACHmC,EAAG+C,MAAM2E,WAAW5I,EAAEoI,SAAWrJ,GACjC6B,EAAUZ,GACVmI,GAAa,EACb,MACF,KAAKpJ,EACH,IAAK+H,EAAQ9F,MAAO,CAClB,IAAI6H,EAAYlC,EAAQmC,KAAK,IAAMrJ,GACZ,EAAnBoJ,EAAU3F,SACZhC,EAAGY,MAAMe,WAAWgG,GACpBjI,EAAUZ,GACVmI,GAAa,GAGjB,MACF,KAAKpJ,EACH,IAAK+H,EAAQ9F,MAAO,CAClB,IAAI+H,EAAYpC,EAAQqC,KAAK,IAAMvJ,GACZ,EAAnBsJ,EAAU7F,SACZhC,EAAGY,MAAMe,WAAWkG,GACpBnI,EAAUZ,GACVmI,GAAa,GAGjB,MACF,QACEjH,EAAG+C,MAAMgF,WAGRd,IACC1B,GAAahI,aAAagI,GAC9BA,EAAc/H,WAAW,WACvB+H,EAAcyC,UACTxC,GAAiBK,KACrB,QAGPoC,MAAoB,SAAUnJ,GACxBkB,EAAGsE,cACPhD,EAAMkF,eAER0B,iBAAoB,WAClB1C,GAAkB,GAGpB2C,eAAoB,WAClB3C,GAAkB,EAClBK,OAMJvE,EAAMmG,SAAW,SAAUW,GACzB,IAAIpI,EAAGkF,eAAP,CAEA,IAAItE,EAAQwH,EAAS3C,EAAQmC,KAAK,IAAMrJ,EAAc,KAAOkH,EAAQqC,KAAK,IAAMvJ,GAC5EqC,IACFU,EAAMuF,cAAgBjB,EAAQ9F,MAC9BsI,EAASxH,EAAMwE,OAAOK,GAAW7E,EAAMiE,MAAMY,GAC7CG,EAAQ9F,IAAIwB,EAAMuF,eAClBvF,EAAMgF,eACChF,EAAMuF,iBAKjBvF,EAAM+G,YAAc,SAAUzH,GAC5B,IAAIZ,EAAGkF,eAEP,GAAItE,EAAOA,EAAMwE,OAAO9D,EAAM7C,QACzB,CACH,IAAI6J,EAAYtI,EAAGY,MAAMkB,eACrBwG,GAAWA,EAAUzD,MAAMvD,EAAM7C,MAKzC6C,EAAMkF,YAAc,WAClBb,EAAWrF,KAAKsF,EAAQ9F,MAAQ,OAIlCwB,EAAM0D,gBAAkB,SAAU1E,EAAMgG,GACtCV,EAAQ9F,IAAIQ,GACPgB,EAAMiF,YAAuB,IAAVD,GAAiBhF,EAAMgF,QAC/ChF,EAAMkF,cACF/I,IAAkB,IAAV6I,GAAiBrH,EAAiB2G,EAAQ,KAIxDtE,EAAMwF,aAAe,SAAUyB,EAAOC,GACpC,IAAIC,EAEAF,EACEvI,EAAGiD,cAAawF,EAAQzI,EAAGY,MAAMgC,IAAI5C,EAAGiD,YAAYH,OACnD2F,EAAQzI,EAAGY,MAAMgC,IAAIgD,EAAQ9F,OAOhCE,EAAGkF,gBACAuD,IAC2B,EAA1BzI,EAAGQ,cAAchB,QAAYQ,EAAGwE,eAAexE,EAAGQ,cAAc,IAChEoF,EAAQ9F,OAAOwB,EAAMoH,SAEtBF,GAAU5C,EAAQnB,OACvBzE,EAAG0E,SACMkB,EAAQ9F,OAAOwB,EAAMoH,SAIlCpH,EAAMmD,KAAO,WACNnD,EAAMiF,WACXX,EAAQnB,QAIVnD,EAAMoH,MAAQ,SAAUC,GACtB/C,EAAQ9F,IAAI,KACK,IAAb6I,EAAoB3I,EAAG2E,YAAYpE,UAClCqF,EAAQnB,OACbkB,EAAWrF,KAAK,MAIlBgB,EAAMsH,cAAgB,WACpB,OAAOhD,EAAQ9F,OAIjBwB,EAAMgF,MAAQ,WACRhF,EAAMiF,WACVX,EAAQU,SAGVX,EAAWrF,KAAK,MAChBgB,EAAMC,YAhcsB9C,EAgcKgH,GA/bvBjE,aAAehD,EAAUC,EAAI,eAAiBD,EAAUC,EAAI,gBAgctEkH,EAAWrF,KAAK,MAIduI,EAAgB,SAAU7I,GAC5B,IAAI+C,EAAQ7C,KAAM4I,EAAU/F,EAAMtE,GAAK3C,EAAEkE,EAAGG,OAAOC,KAAKlC,aAAawH,SAAS1F,EAAGvB,IAGjFsE,EAAM2E,WAAa,SAAUqB,GAC3B,IAA+CC,EAA3CC,EAAUH,EAAQrH,SAAS,eAA4ByH,EAAU,IAAM3K,EACvE4K,GAAgBnJ,EAAGkF,gBAAkBlF,EAAGG,OAAOiJ,2BAEnD,GADID,IAAcD,GAAW,SAAW3K,EAAmB,KACtC,EAAjB0K,EAAQjH,OAAY,CAGtB,IAFAgH,EAAaD,EAAOE,EAAQrB,OAASqB,EAAQnB,OAElB,EAApBkB,EAAWhH,UACZgH,EAAWK,SAAS9K,IAAuB4K,GAAiBH,EAAWK,SAAS9K,KAEpFyK,EAAaD,EAAOC,EAAWpB,OAASoB,EAAWlB,OAGrD,GAAIkB,EAAWhH,QAAU,EAEJ,GADfsH,EAAQR,EAAQrH,SAASyH,IACnBlH,SAAYgH,EAAoBlN,EAAPiN,EAASO,EAAMA,EAAMtH,OAAS,GAAQsH,EAAM,SAE5E,CACL,IAAIA,EACe,GADfA,EAAQR,EAAQrH,SAASyH,IACnBlH,SAAYgH,EAAoBlN,EAAPiN,EAASO,EAAMA,EAAMtH,OAAS,GAAQsH,EAAM,KAG7EN,GAAkC,EAApBA,EAAWxJ,SAC3ByJ,EAAQrC,YAAY,YACpBoC,EAAW3E,SAAS,YACpBtB,EAAMwG,iBAAiBP,KAK3BjG,EAAMwG,iBAAmB,SAAUC,GAEjC,GAA0B,GAD1BA,EAAeA,GAAgBV,EAAQrH,SAAS,gBAC/BO,OAAY,CAC3B,IAAIyH,EAAYX,EAAQW,YAAahH,EAAM+G,EAAajH,WAAWE,IAAMgH,EACzEhH,IAAaqG,EAAQY,SAAWF,EAAaE,UAAY,EACzDZ,EAAQW,UAAUhH,KAKtBM,EAAMC,gBAAkB,WACtB,OAAO8F,EAAQrH,SAAS,eAAekI,KAAK,uBAI9C5G,EAAMqD,OAAS,WACb,IAAIuD,EAAO3J,EAAG2J,MAAQ,GAAIC,EAAa5J,EAAGsB,MAAMsH,gBAChDE,EAAQ/C,QACR+C,EAAQW,YAER,IAAIvG,EAAKlD,EAAGiD,aAAejD,EAAGiD,YAAYH,MAAQ,GAAIK,EAASD,EAAGE,GAAKF,EAAGG,KAAMC,EAASJ,EAAGK,GAAKL,EAAGM,KACpG,GAAkB,EAAdmG,EAAKnK,OAAY,CACnB,IAAqBqK,EAEjBC,EAFAC,GAAU,EACVC,GAAehK,EAAGkF,eAAgBkE,EAA6BpJ,EAAGG,OAAOiJ,2BAC5Da,EAAsB,EAAGC,EAAsB,EAEhEpO,EAAE4F,KAAKiI,EAAM,SAAUQ,EAAGrH,GACxB,IAAIsH,EAAQvG,EAAWf,EAAKS,GAAKT,EAAKU,KAAM2D,EAAWrE,EAAKM,GAAKN,EAAKO,KACpES,EAAiBhB,EAAKiB,IAAMjB,EAAKkB,SAAUqG,GAAa,EAC1D,GAAIrK,EAAGG,OAAOmK,WAAYF,EAASpK,EAAGG,OAAOmK,WAAWpG,KAAKlE,EAAI8C,EAAM8G,OAClE,CAEH,IAAItJ,GADJ8J,EAAStO,EAAEkE,EAAGG,OAAOC,KAAK/B,kBACR0C,KAAK,SACnBf,EAAGG,OAAOgE,YAAa7D,EAAKvB,OAAOF,EAAM/C,EAAEgI,GAAkBD,KAC5DvD,EAAKA,KAAKuD,GAGjB,GAAImG,EAAa,CACf,IAAIR,EAAexJ,EAAGuK,gBAAgBpD,GAClCqC,IAEAA,IAAiB1G,IAChB0G,EAAapG,GAAKoG,EAAanG,QAAU8D,IACzCqC,EAAajG,GAAKiG,EAAahG,QAAUK,KAG5CuG,EAAO/F,SAAS9F,GACZ6K,IACFiB,GAAa,EACbD,EAAO/F,SAAS9F,MAKA,IAAlBuE,EAAK0H,UACPH,GAAa,EACbD,EAAO/F,SAAS,yBACXwF,IACHA,GAAc,EACdf,EAAQzE,SAAS,4BAGfyF,GAAeG,GAAuB,GACxCH,EAAYzF,SAAS,8BAEvByF,EAAcM,EACdH,EAAsB,IAElBH,GAAeO,GAAYJ,IAC3BI,GAAYH,IAChBE,EAAO/F,SAAS9F,IAEduE,EAAK9G,KAAKoO,EAAO/F,SAASvB,EAAK9G,KAEnCoO,EAAOT,KAAK,qBAAsB7G,GAAM4C,SAASoD,GAC9C1E,KAAK,QAASP,GACd4G,UAAU,SAAU3L,GACfkB,EAAGsE,eACHxB,EAAK0H,WAKL/M,GAAMuC,EAAGsB,MAAMmD,OACnBzE,EAAGsB,MAAMoH,QACT1I,EAAGY,MAAMgC,IAAIE,IANXpD,EAAUZ,OAUXiL,GAAWH,IACV5J,EAAGiD,aAAejD,EAAGiD,YAAY3C,MAAQsJ,GACvCzG,GAAUgE,GAAY7D,GAAUO,IAClCkG,GAAU,GAEV/J,EAAG8E,eAAe,SAAW8E,GAAc/F,EAC7CkG,GAAU,EACD/J,EAAG8E,eAAe,SAAW8E,GAAczC,IACpD4C,GAAU,GAERA,GAASK,EAAO/F,SAAS,eAI7ByF,GAAeG,GAAuB,GACxCH,EAAYzF,SAAS,8BAEnB6F,GAAuB,EACzBpB,EAAQzE,SAAS,uBAEjByE,EAAQlC,YAAY,4BAGjB5G,EAAG0E,SAIZ3B,EAAMlC,OAAS,WACbiI,EAAQpK,IAAI,YAAasB,EAAGvB,GAAGiM,SAC/B1K,EAAG2K,kBAAkB3K,IAIvB+C,EAAMgF,SAAW,WACf,IAAI6C,EAAe5K,EAAGsB,MAAM7C,GAAG8D,WAAWC,KACtCxC,EAAGkF,iBAAgB0F,EAAe,GACtC9B,EAAQpK,IAAI,OAAQkM,EAAe,OAIrC7H,EAAM2B,MAAQ,WACZoE,EAAQrH,WAAWmF,YAAY,aAIjC7D,EAAM8H,QAAU,WACd/B,EAAQrH,WAAWC,KAAK,WACtB5F,EAAEoE,MAAM4K,WAAW,wBAErBhC,EAAQvE,WAKRwG,EAAe,SAAU5K,EAAQ6K,GACnC,IAAIhL,EAAKE,KAET,IAAK,IAAI+K,KADT9K,EAASrE,EAAEoP,QAAO,EAAM,CAAC9K,KAAMtC,GAAOqC,GAAU,IAChCpE,EAAqC,oBAAhBoE,EAAO8K,KAAsB9K,EAAO8K,GAAOlP,EAASkP,IACzFjL,EAAGG,OAASA,EAAQH,EAAGmL,aAAc,EAAOnL,EAAGQ,cAAgB,GAAIR,EAAGuK,gBAAkB,GAAIvK,EAAGoL,UAAW,EAG1G,IAAIC,EAAkB,WACfrL,EAAGsL,mBACFtL,EAAGvB,GAAG8M,GAAG,aAAavL,EAAGa,SAC7B/E,EAAE,QAAQ0P,IAAI,YAAaH,GAC3BrL,EAAGsL,kBAAmB,IAKtBG,EAAmB,SAAU3M,GAC/B,GAAKkB,EAAGvB,GAAG4K,SAAS,UAChBvN,EAAEgD,EAAE4M,QAAQrC,SAAS,0BAAzB,CAEA,IAAIsC,EAAe7P,EAAEgD,EAAE4M,QAAQE,QAAQ,2BACZ,GAAvBD,EAAa3J,OAAahC,EAAG0E,QACxBiH,EAAa,IAAM3L,EAAGvB,GAAG,IAAIuB,EAAG0E,UAKvCmH,EAAoB,SAAU/M,GAEhCtB,WAAW,WACTwC,EAAG+C,MAAMlC,UACR,MAIDiL,EAAgB,WACb9L,EAAG+L,iBACF/L,EAAGvB,GAAG8M,GAAG,aAAavL,EAAGa,SAC7Bb,EAAGvB,GAAG+M,IAAI,YAAaM,GACvB9L,EAAG+L,gBAAiB,IAKxB/L,EAAGgM,SAAW,SAAU1C,EAAO2C,GAC7BA,EAAOnQ,EAAEoP,OAAO,CAACgB,YAAapQ,EAAEqQ,MAAOF,GAAQ,IAE/C,IAAsCG,EAAlCC,EAAmBrM,EAAG0G,WAE1B,GADIuF,EAAKvD,OAAO1I,EAAGsM,YAAW,IACzBhD,EAGH,OAFA2C,EAAKM,SAAWvM,EAAGwM,aAAeJ,EAAcpM,EAAGyM,aAAaJ,EAAkBrM,EAAG0G,iBACrFuF,EAAKC,YAAYhI,KAAKlE,EAAIoM,GAI5B,GAAM9C,aAAiBoD,MAGhB,CAAA,GAAIpD,EAAM9J,QAAU,EACzB,OAEA,IAAImN,EAAgB,GACpB7Q,EAAE4F,KAAK4H,EAAO,SAAUa,EAAGrH,GACrBjD,EAASiD,GAAO6J,EAAcC,KAAK,CAACxJ,EAAGN,EAAMS,EAAGT,IAC/C6J,EAAcC,KAAK9J,KAE1BwG,EAAQqD,OAVarD,EAAjBzJ,EAASyJ,GAAgB,CAAC,CAAClG,EAAGkG,EAAO/F,EAAG+F,IAC/B,CAACA,GAYhB,GAAItJ,EAAGG,OAAOzD,aAAesD,EAAGG,OAAO0M,cACrC7M,EAAG6M,cAAcvD,GAAOpD,KAAK,SAAU4G,GACrChR,EAAE4F,KAAK4H,EAAO,SAAUa,EAAGrH,GACzB9C,EAAGY,MAAMgC,IAAIE,EAAMgK,OAEpBC,OAAO,WACRd,EAAKM,SAAWvM,EAAGwM,aAAeJ,EAAcpM,EAAGyM,aAAaJ,EAAkBrM,EAAG0G,YACrFuF,EAAKC,YAAYhI,KAAKlE,EAAIoM,SAEvB,CACL,IAAIY,EAAiBhN,EAAG2J,KAAMsD,EAAkBjN,EAAGG,OAAOzD,aAAesD,EAAGG,OAAO6F,WAAY,EAC3FkH,EAAe5D,EAAM9J,OAAQ2N,EAAmB,EACjC,EAAf7D,EAAM9J,SAAeyN,IAAiBjN,EAAG2J,MAAQ3J,EAAGG,OAAOwJ,MAAQ,IAAIyD,SAC3EtR,EAAE4F,KAAK4H,EAAO,SAAUa,EAAGrH,GACzB,GAAImK,EACF,GAAIjN,EAAG4D,aAAad,EAAMkK,GACxBhN,EAAGY,MAAMgC,IAAIE,GACbqK,QACK,CACL,IAAIhG,EAAWrE,EAAKM,GAAKN,EAAKO,KAAMQ,EAAWf,EAAKS,GAAKT,EAAKU,KAC1DtH,EAAa8D,EAAG8E,eAAe,QAAU,OAAS,OAClD8E,EAA2B,QAAd1N,EAAuBiL,EAAWtD,EACnD7D,EAAGgG,SAAS,CACV4D,WAA4BA,EAC5ByD,YAHqE,GAIrEC,4BAA4B,EAC5BpR,WAA4BA,EAC5B+J,KAA4B,aAC3BC,KAAK,SAAU4G,GAChBE,EAAiBF,EACjB9M,EAAGY,MAAMgC,IAAIE,EAAMgK,KAClBC,OAAO,aACFI,GAAoBD,IACxBjB,EAAKM,SAAWvM,EAAGwM,aAAeJ,EAAcpM,EAAGyM,aAAaJ,EAAkBrM,EAAG0G,YACrFuF,EAAKC,YAAYhI,KAAKlE,EAAIoM,WAI3BpM,EAAGY,MAAMgC,IAAIE,KAEjBmK,IACHhB,EAAKM,SAAWvM,EAAGwM,aAAeJ,EAAcpM,EAAGyM,aAAaJ,EAAkBrM,EAAG0G,YACrFuF,EAAKC,YAAYhI,KAAKlE,EAAIoM,MAMhCpM,EAAGuN,SAAW,SAAUjE,EAAO2C,GAC7BA,EAAOnQ,EAAEoP,OAAOe,GAAQ,GAAI,CAACvD,OAAO,IACpC1I,EAAGgM,SAAS1C,EAAO2C,IAIrBjM,EAAGyG,YAAc,WACf,IAAI6G,EAA6BtN,EAAGG,OAAOqN,mCAAqCxN,EAAGG,OAAOzD,aAAesD,EAAGkF,eAC5GlF,EAAGgG,SAAS,CAACsH,2BAA4BA,EAA4BrH,KAAM,gBAAgBC,KAAK,WAC9FlG,EAAGmG,OACHnG,EAAG+C,MAAMqD,YAKbpG,EAAG8E,eAAiB,SAAU2I,GAC5B,OAA6C,GAAtCzN,EAAGG,OAAOjE,WAAW0B,QAAQ6P,IAItCzN,EAAGa,OAAS,WACVb,EAAGY,MAAMC,UAIXb,EAAG6K,QAAU,WACX7K,EAAG8F,WAAY,EACf9F,EAAG+C,MAAM8H,UACT/O,EAAE,QAAQ0P,IAAI,CAAC3J,MAAS4J,EAAkBiC,UAAarC,IACvDvP,EAAE6R,QAAQnC,IAAI,SAAUK,GACxB7L,EAAGG,OAAO1B,GAAGqM,WAAW,kBACxB9K,EAAGvB,GAAG8F,UAIRvE,EAAGyM,aAAe,SAAUmB,EAAUC,GACpC,IAAIC,GAAO,EACX,GAAIF,GAAYC,GAAYD,EAASpO,QAAUqO,EAASrO,OAAQ,CAC9D,IAAIuO,GAAe,EACnBjS,EAAE4F,KAAKkM,EAAU,SAAUzD,EAAG6D,GAC5B,IAAIC,EAAcD,EAAQ3K,MAAQ2K,EAAQ5K,EAAG8K,EAAcF,EAAQxK,MAAQwK,EAAQzK,EAC/E4K,EAAUN,EAAS1D,GAAIiE,EAAcD,EAAQ9K,MAAQ8K,EAAQ/K,EAAGiL,EAAcF,EAAQ3K,MAAQ2K,EAAQ5K,EAC1G,GAAI0K,GAAeG,GAAeF,GAAeG,EAE/C,OADAN,GAAe,IAIfA,IAAcD,GAAO,GAO3B,OALIA,KACuC,IAArC9N,EAAGG,OAAOmO,wBAAoCtO,EAAGuO,iBACnD/Q,WAAW,WAAcwC,EAAGwO,YAAY9E,OAAO1J,EAAGvB,GAAGkE,gBAAmB,GAC1E3C,EAAGG,OAAO1B,GAAGgQ,QAAQ,yBAA0B,CAACb,EAAUC,KAErDC,GAIT9N,EAAG2K,kBAAoB,WACrB3K,EAAGG,OAAO1B,GAAGgQ,QAAQ,+BAAgC,CAACzO,KAIxDA,EAAG0O,aAAe,SAAU5L,EAAMwG,GAChCtJ,EAAGG,OAAO1B,GAAGgQ,QAAQ,yBAA0B,CAAC3L,EAAMwG,KAIxDtJ,EAAG2O,YAAc,WACX3O,EAAG4O,cAAc5O,EAAG4O,aAAahI,YAAY,QACjD5G,EAAGG,OAAO1B,GAAGgQ,QAAQ,0BAIvBzO,EAAGwM,WAAa,WACVxM,EAAG6O,gBAEP7O,EAAG6O,eAAgB,EACnB7O,EAAGG,OAAO1B,GAAGgQ,QAAQ,4BAIvBzO,EAAG2G,YAAc,WACX3G,EAAG4O,cAAc5O,EAAG4O,aAAavK,SAAS,SAC9CrE,EAAGG,OAAO1B,GAAGgQ,QAAQ,0BAIvBzO,EAAG8O,UAAY,WACT9O,EAAG4O,cAAc5O,EAAG4O,aAAavK,SAAS,QAC9CrE,EAAGG,OAAO1B,GAAGgQ,QAAQ,yBAIvBzO,EAAG4E,iBAAmB,WACpB5E,EAAGG,OAAO1B,GAAGgQ,QAAQ,kCAIvBzO,EAAG+G,WAAa,WACV/G,EAAG4O,cAAc5O,EAAG4O,aAAahI,YAAY,SACjD5G,EAAGG,OAAO1B,GAAGgQ,QAAQ,yBAIvBzO,EAAG+O,eAAiB,SAAUjM,EAAMwG,GAClCtJ,EAAGG,OAAO1B,GAAGgQ,QAAQ,2BAA4B,CAAC3L,EAAMwG,KAI1DtJ,EAAGkF,aAAe,WAChB,OAAQlF,EAAGG,OAAOvD,UAIpBoD,EAAG0E,MAAQ,WACT1E,EAAGvB,GAAGmI,YAAY,QAClB5G,EAAG+C,MAAM2B,QACT1E,EAAG2O,eAIL3O,EAAGmG,KAAO,WACJnG,EAAGoL,WACPpL,EAAG+C,MAAMlC,SACTb,EAAG+C,MAAMgF,WACT/H,EAAGvB,GAAG4F,SAAS,QACfrE,EAAG8O,cAIL9O,EAAG0G,SAAW,WACZ,OAAO1G,EAAGQ,cAAc4M,SAI1BpN,EAAGgP,UAAY,WACbhP,EAAG2J,KAAKsF,OAAO,EAAGjP,EAAG2J,KAAKnK,SAI5BQ,EAAGsM,WAAa,SAAUwB,GACpB9N,EAAGkF,gBAAgBlF,EAAGsB,MAAMoH,MAAMoF,GAEtC,IAAIzB,EAAmBrM,EAAG0G,WAC1B1G,EAAGQ,cAAcyO,OAAO,EAAGjP,EAAGQ,cAAchB,QAC5CQ,EAAGuK,gBAAkB,GACrBvK,EAAGvB,GAAGgD,SAAS,IAAMlD,GAAagG,SAClCvE,EAAGvB,GAAGmI,YAAY,YAClB5G,EAAG2E,YAAYpE,WACF,IAATuN,IACF9N,EAAGG,OAAO1B,GAAGgQ,QAAQ,yBACrBzO,EAAGyM,aAAaJ,EAAkBrM,EAAG0G,cAKzC1G,EAAGkP,YAAc,SAAU9D,GACzBA,GAAwB,IAAbA,GACXpL,EAAGoL,SAAWA,GACApL,EAAGvB,GAAG4F,SAAS,YACxBrE,EAAGvB,GAAGmI,YAAY,aAIzB5G,EAAGsE,WAAa,WACd,OAAOtE,EAAGoL,UAIZpL,EAAGqF,YAAc,SAAUvC,EAAMgL,GAC/B,IAAIzB,EAAmBrM,EAAGQ,cAAc4M,QAEpCpN,EAAGkF,iBACLlF,EAAGQ,cAAcyO,OAAO,EAAGjP,EAAGQ,cAAchB,QAC5CQ,EAAGuK,gBAAkB,IAGvBvK,EAAGQ,cAAcoM,KAAK9J,GACtB9C,EAAGuK,gBAAgBzH,EAAKM,GAAKN,EAAKO,MAAQP,EACZ,EAA1B9C,EAAGQ,cAAchB,QAAYQ,EAAGvB,GAAG4F,SAAS,aAEnC,IAATyJ,IACF9N,EAAG0O,aAAa5L,EAAM9C,EAAG0G,YACzB1G,EAAGyM,aAAaJ,EAAkBrM,EAAG0G,cAKzC1G,EAAGwE,eAAiB,SAAU1B,GAC5B,IAAIqM,EAAYnP,EAAGmF,iBAAiBrC,GACpC,GAAiB,GAAbqM,EAAgB,CAClB,IAAI9C,EAAmBrM,EAAGQ,cAAc4M,QACxCpN,EAAGQ,cAAcyO,OAAOE,EAAW,UAC5BnP,EAAGuK,gBAAgBzH,EAAKM,GAAKN,EAAKO,MACrCrD,EAAGQ,cAAchB,QAAU,GAAGQ,EAAGvB,GAAGmI,YAAY,YAEpD5G,EAAG+O,eAAejM,EAAM9C,EAAG0G,YAC3B1G,EAAGyM,aAAaJ,EAAkBrM,EAAG0G,cAKzC1G,EAAGoP,cAAgB,SAAUxF,EAAY9G,GACvC,IAAIuM,EAAQ,IAAIC,OAp8BF,SAAUC,GAC1B,GAAmB,iBAARA,EAAkB,OAAOA,EAEpC,OAAOA,EAAI3Q,QADY,sBACc,QAi8BZ4Q,CAAY5F,GAAa5J,EAAGG,OAAOhE,WAAa,IAAM6L,WACzE+B,GAAU,EAGd,OAFI/J,EAAG8E,eAAe,UAASiF,EAAUsF,EAAMI,KAAK3M,EAAKS,GAAKT,EAAKU,QAC9DuG,GAAW/J,EAAG8E,eAAe,UAASiF,EAAUsF,EAAMI,KAAK3M,EAAKM,GAAKN,EAAKO,OACxE0G,GAIT/J,EAAGmF,iBAAmB,SAAUrC,GAC9B,IAAI4M,GAAU,EAAGvI,EAAWrE,EAAKM,GAAKN,EAAKO,KAAMQ,EAAWf,EAAKS,GAAKT,EAAKU,KAQ3E,OAPA1H,EAAE4F,KAAK1B,EAAGQ,cAAe,SAAU2J,EAAGlB,GACpC,IAAI0G,EAAU1G,EAAQ7F,GAAK6F,EAAQ5F,KAAMuM,EAAU3G,EAAQ1F,GAAK0F,EAAQzF,KACxE,GAAImM,GAAWxI,GAAYyI,GAAW/L,EAEpC,OADA6L,EAASvF,GACF,IAGJuF,GAIT1P,EAAG4D,aAAe,SAAUd,EAAM6G,GAChC,IAAIkG,EAAYhQ,EAASiD,GACrB+M,IAAW/M,EAAO,CAACM,EAAGN,EAAMS,EAAGT,IACnC,IAAIa,EAAUwD,EAAWrE,EAAKM,GAAKN,EAAKO,KAAMQ,EAAWf,EAAKS,GAAKT,EAAKU,KAAMmG,EAAOA,GAAQ3J,EAAG2J,KAgBhG,OAdA7N,EAAE4F,KAAKiI,EAAM,SAAUQ,EAAG2F,GACxB,IAAIC,EAAWD,EAAS1M,GAAK0M,EAASzM,KAAM2M,EAAWF,EAASvM,GAAKuM,EAAStM,KAC9E,GAAIqM,GACF,GAAI7P,EAAG8E,eAAe,SAAWkL,GAAYnM,GAAY7D,EAAG8E,eAAe,SAAWiL,GAAY5I,EAEhG,OADAxD,EAAWmM,GACJ,OAGT,GAAIE,GAAYnM,GAAYkM,GAAY5I,EAEtC,OADAxD,EAAWmM,GACJ,IAINnM,GAIT3D,EAAG6M,cAAgB,SAAUvD,GAC3B,IAAI2G,EAAUnU,EAAEoU,WACZC,EAAc,GAYlB,OAVAnQ,EAAGG,OAAO0M,cAAc3I,KAAKlE,EAAIsJ,EAAO,SAAUK,GAC5CA,GACF7N,EAAE4F,KAAKiI,EAAM,SAAUQ,EAAGrH,GACpBjD,EAASiD,KAAOA,EAAO,CAACM,EAAGN,EAAMS,EAAGT,IACxCqN,EAAYvD,KAAK9J,KAEnBmN,EAAQG,QAAQD,IACXF,EAAQI,WAGVJ,EAAQK,WAIjBtQ,EAAGgG,SAAW,SAAUiG,IACtBA,EAAOA,GAAQ,IACVrC,WAAaqC,EAAKqB,2BAA6B,GAAMrB,EAAKrC,YAAc5J,EAAGsB,MAAMsH,gBACtF,IAAIqH,EAAUnU,EAAEoU,WAIhB,GAFAjE,EAAKoB,YAAcpB,EAAKoB,aAAerN,EAAG2J,KAC1CsC,EAAKoB,YAAY4B,OAAO,EAAGhD,EAAKoB,YAAY7N,QACxCQ,EAAGG,OAAO6F,SACZhG,EAAGG,OAAO6F,SAAS9B,KAAKlE,EAAIiM,EAAKrC,WAAY,SAAUD,GACjDA,GACFsC,EAAKoB,YAAY4B,OAAO,EAAGhD,EAAKoB,YAAY7N,QAC5C1D,EAAE4F,KAAKiI,EAAM,SAAUQ,EAAGrH,GACpBjD,EAASiD,KAAOA,EAAO,CAACM,EAAGN,EAAMS,EAAGT,IACxCmJ,EAAKoB,YAAYT,KAAK9J,KAExBmN,EAAQG,QAAQnE,EAAKoB,cAChB4C,EAAQI,UACdpE,EAAK/P,WAAY+P,EAAKhG,UACpB,CACL,IAAiCsK,EAA7B5G,EAAO3J,EAAGG,OAAOwJ,MAAQ,GAC7B7N,EAAE4F,KAAKiI,EAAM,SAAUQ,EAAGrH,GACpBjD,EAASiD,KAAOA,EAAO,CAACM,EAAGN,EAAMS,EAAGT,KAClB,IAAlBA,EAAK0H,SAILyB,EAAKrC,aAAe5J,EAAGoP,cAAcnD,EAAKrC,WAAY9G,KACtDyN,IACFtE,EAAKoB,YAAYT,KAAK2D,GACtBA,EAAgBvI,WAElBiE,EAAKoB,YAAYT,KAAK9J,IARpByN,EAAgBzN,IAUpBmN,EAAQG,QAAQnE,EAAKoB,aAEvB,OAAO4C,EAAQK,WAGjBtQ,EAAG2J,KAAO,GAAI3J,EAAGvB,GAAK3C,EAAEkE,EAAGG,OAAOC,KAAKpC,cAAcqG,SAASrE,EAAGG,OAAOnE,KAGxE,IAOIwU,EAPA5B,EAAe5O,EAAG4O,aAAezO,EAAO1B,GAAGgS,QAAQ,gBACrDC,EAAoB1Q,EAAG0Q,kBAA0C,EAAtB9B,EAAa5M,OAEtD2O,EAAkBxQ,EAAO1B,GAAG8M,GAAG,UAC/BoF,IAAoB3Q,EAAGG,OAAOvB,UAASoB,EAAGG,OAAOvB,SAAU,GAI3D+R,GAAmBxQ,EAAO1B,GAAGmS,SAASvH,SAAS,kBACjDmH,EAAoBxQ,EAAGwQ,kBAAoB1U,EAAEkE,EAAGG,OAAOC,KAAKrC,2BACzDsG,SAAS,iBACMwM,YAAY1Q,EAAO1B,IACrC0B,EAAO1B,GAAGiH,SAAS8K,KAGM,IAAvBxQ,EAAGG,OAAO/D,UAAoB4D,EAAGvB,GAAG4F,SAAS,aAC7CrE,EAAGG,OAAO9D,QAAQ2D,EAAGvB,GAAG4F,SAAS,UACjCrE,EAAGG,OAAOvB,SACZoB,EAAGvB,GAAGoS,YAAY1Q,EAAO1B,IACzB0B,EAAO1B,GAAGgC,QAEN+P,EACFxQ,EAAGvB,GAAGiH,SAAS8K,IAEXE,GAAmBvQ,EAAO1B,GAAG4F,SAAS,gBAC1CrE,EAAGvB,GAAGiH,SAASvF,EAAO1B,KAI1B,IAAIqS,EAAW9Q,EAAGwO,YAAcxO,EAAGvB,GAAGmS,SAAUG,EAAkB,kBAC9DL,GAAqBI,EAASzH,SAAS,iBAAiByH,EAASzM,SAAS0M,GAC9E/Q,EAAGuO,gBAAkBuC,EAASzH,SAAS0H,GAEvC/Q,EAAGsB,MAAQ,IAAIgE,EAAMtF,GACrBA,EAAG+C,MAAQ,IAAI8F,EAAc7I,GAC7BA,EAAGY,MAAQ,IAAID,EAAMX,GACrBA,EAAG2E,YAAc,IAAI5E,EAAYC,GAC7BA,EAAGG,OAAOwJ,OACZ7N,EAAE4F,KAAK1B,EAAGG,OAAOwJ,KAAM,SAAUQ,EAAGrH,GAC9BjD,EAASiD,GAAO9C,EAAG2J,KAAKiD,KAAK,CAACxJ,EAAGN,EAAMS,EAAGT,IACzC9C,EAAG2J,KAAKiD,KAAK9J,KAEpB9C,EAAGG,OAAOwJ,KAAO3J,EAAG2J,KAAKyD,SAIzBtR,EAAEkE,EAAGG,OAAOC,KAAKhC,aAAasH,SAAS1F,EAAGvB,IAAIoD,MAAM,SAAU/C,GACxDkB,EAAGsE,eAEPtE,EAAGsM,aACH5M,EAAUZ,MAIVkB,EAAGG,OAAOiL,UAAUpL,EAAGkP,aAAY,GAEvClP,EAAGvB,GAAG4H,GAAG,CACPoE,UAAW,SAAU3L,GACnB,IAAIkB,EAAGsE,cAEHxF,EAAE4M,QAAU1L,EAAGvB,GAAG,GAAI,CACxB,IAAImC,EAAQZ,EAAGY,MAAMqB,eAAenD,EAAEkS,QAASlS,EAAEmS,SACjDjR,EAAGsB,MAAM+G,YAAYzH,GACjBZ,EAAGsB,MAAMiF,WAAW7G,EAAUZ,KAItC+C,MAAW,SAAU/C,GACfkB,EAAGsE,eACPtE,EAAGsB,MAAMgF,QACLtG,EAAGsB,MAAMiF,WAAW7G,EAAUZ,KAEpC4O,UAAW5B,IAGbd,EAASrB,KAAK,iBAAkBzJ,MAC5BF,EAAGG,OAAOZ,MAAOS,EAAGuN,SAASvN,EAAGG,OAAOZ,MAAO,CAACgN,UAAU,IACxDvM,EAAGwM,aAER1Q,EAAE,QAAQuK,GAAG,CAACxE,MAAS4J,EAAkBiC,UAAarC,IACtDvP,EAAE6R,QAAQtH,GAAG,SAAUwF,IAGzB/P,EAAEiB,GAAGmU,eAAiB,SAAU/Q,GAC9B,IAAIgR,EAAOC,UACX,OAAOlR,KAAKwB,KAAK,WACf,GAAKxB,KAAL,CACA,IAAImR,EAAQvV,EAAEoE,MAEVgR,EAAiBG,EAAM1H,KAAK,kBAC3BuH,GAA4B,WAAV/Q,IACrBA,EAASrE,EAAEoP,OAAO,CAChBzM,GAAI4S,EAAO9R,MAAO8R,EAAMvR,MAAQuR,EAAMvR,MAAMwR,MAAMnR,EAAOoR,WAAa,KAAO,IAC5EpR,GACH+Q,EAAiB,IAAInG,EAAa5K,EAAQkR,IAExCH,GAAkBrR,EAASM,IAC7B+Q,EAAe/Q,GAAQqR,MAAMN,EAAgBxE,MAAM+E,UAAUrE,MAAMlJ,KAAKiN,EAAM,QA7tCtF,CAiuCGO","file":"bootstrap-autocomplete.min.js","sourcesContent":["(function ($) {\n  'use strict';\n\n  // DEF_OPTS\n  var DEF_OPTS = {\n    cls             : '',\n    placeHolder     : '请选择',\n    searchMode      : 'code name',\n    ignoreCase      : true,\n    fitWdith        : true,\n    dropUp          : false,\n    filtSame        : false,\n    badgeCls        : '',\n    dblclick4Edit   : false,\n    inputSearchDelay: 200,\n    forceSelect     : false,\n    minChar         : 1,\n    multiple        : true,\n    debounceFn      : function (delay, fn, atBegin) {\n      if ($.debounce) return $.debounce(delay, atBegin, fn);\n      else {\n        var mockDebounceTimeout = -1, lastTimeoutId = -1;\n        return function () {\n          var now = +new Date().getTime();\n          if (mockDebounceTimeout < 0 || (now - mockDebounceTimeout) > delay) {\n            mockDebounceTimeout = now;\n\n            if (lastTimeoutId > 0) {\n              clearTimeout(lastTimeoutId);\n              lastTimeoutId = -1;\n            }\n\n            lastTimeoutId = setTimeout(function () {\n              lastTimeoutId = -1;\n              mockDebounceTimeout = -1;\n              fn();\n            }, delay);\n          }\n        }\n      }\n    }\n  };\n\n  var isIE = navigator.userAgent.indexOf('Trident') > -1;\n\n  // KEY_CODES\n  var KEY_CODES = {\n    ENTER: 13, TAB: 9, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40, ESC: 27, BACK: 8, DELETE: 46\n  };\n\n  // TPLS\n  var TPLS = {\n    inputDelegateContainerTpl: '<div class=\"input-delegate-ct\"></div>',\n    containerTpl             : '<div class=\"btn-group bootstrap-autocomplete form-control\"></div>',\n    inputTpl                 : '<div class=\"delegate-input\">\\\n        <input type=\"text\" class=\"input-delegate\">\\\n        <span class=\"input-delegate-sizer\">W</span>\\\n      </div>',\n    dropdownTpl              : '<ul class=\"dropdown-menu bs-autocomplete-menu\"></ul>',\n    placeholderTpl           : '<div class=\"bs-autocomplete-placeholder\"></div>',\n    clearBtnTpl              : '<span class=\"bsautocomplete-icon-cross bsautocomplete-font icon-jiaochacross78\"></span>',\n    dropdownItemTpl          : '<li>\\\n        <a href=\"javascript:\">\\\n          <span class=\"text\"></span>\\\n        </a>\\\n      </li>',\n    badgeTpl                 : '<span class=\"label label-primary\">\\\n        <a href=\"javascript:\" class=\"badge-text\"></a>\\\n        <a href=\"javascript:\" class=\"badge-close\">x</a>\\\n      </span>'\n  };\n\n  // CLS\n  var CLS = {\n    badgeCt      : 'bs-autocomplete-badge',\n    dropdownItem : 'bs-autocomplete-item',\n    multiSelected: 'multiple-selected',\n    multiHideSel : 'multiple-hide-selected',\n  };\n\n  // escapeRegex\n  var escapeRegex = function (str) {\n    if (typeof str !== 'string') return str;\n    var matchOperatorsRe = /[|\\\\{}()[\\]^$+*?.]/g;\n    return str.replace(matchOperatorsRe, '\\\\$&');\n  };\n\n  // getInnerSize\n  var getInnerWidth = function (el) {\n    var padL = getCssNum(el, 'padding-left'), padR = getCssNum(el, 'padding-right');\n    return el.innerWidth() - padL - padR;\n  };\n\n  // getOuterWidth\n  var getOuterWidth = function (el) {\n    return el.outerWidth() + getCssNum(el, 'margin-left') + getCssNum(el, 'margin-right');\n  };\n\n  // getCaretPosition\n  var getCaretPosition = function (oField) {\n    var caretPos = 0;\n    if (document.selection) {// IE\n      var oSel = document.selection.createRange();\n      oSel.moveStart(\"character\", 0 - oField.value.length);\n      caretPos = oSel.text.length;\n    } else if (oField.selectionStart || oField.selectionStart == \"0\") { // Firefox\n      caretPos = oField.selectionStart;\n    }\n    return caretPos;\n  };\n\n  // getCssNum\n  var getCssNum = function (el, css) {\n    return Number(el.css(css).replace('px', ''));\n  };\n\n  // getOuterHtml\n  var ohtml = function (e) {\n    return $('<div></div>').append(e).html();\n  };\n\n  // setCaretPosition\n  var setCaretPosition = function (oField) {\n    if (document.selection) {// IE\n      var oSel = document.selection.createRange();\n      oSel.moveStart(\"character\", oField.value.length);\n    } else { // Firefox\n      oField.selectionStart = oField.value.length;\n    }\n  };\n\n  // stopEvent\n  var stopEvent = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  // isString\n  var isString = function (val) {\n    return typeof val === typeof '';\n  };\n\n  // PlaceHolder\n  var PlaceHolder = function (ac) {\n    var placeholder = this, placeholderEl = placeholder.el = $(ac.params.tpls.placeholderTpl).prependTo(ac.el);\n    placeholderEl.text(ac.params.placeHolder);\n\n    placeholder.refresh = function () {\n      if (ac.selectedItems.length > 0) placeholderEl.hide();\n      else placeholderEl.show();\n    };\n  };\n\n  // Badge\n  var Badge = function (ac) {\n    var badge = this;\n\n    // resize\n    badge.resize = function (el) {\n      if (el) {\n        var closeEl = el.find('.badge-close');\n        var badgeMarginL = getCssNum(el, 'margin-left'), badgeMarginR = getCssNum(el, 'margin-right');\n        var maxWidth = getInnerWidth(ac.el) - ac.input.emptyWidth - badgeMarginL - badgeMarginR - closeEl.outerWidth() - 2;\n        el.find('.badge-text').css('max-width', maxWidth + 'px');\n      } else {\n        ac.el.children('.' + CLS.badgeCt).each(function () {\n          badge.resize($(this));\n        });\n      }\n    };\n\n    // closeBadge\n    badge.closeBadge = function (badgeEl) {\n      badgeEl.find('.badge-close').click();\n    };\n\n    // getLastBadge\n    badge.getLastBadge = function () {\n      var badges = ac.el.children('.' + CLS.badgeCt);\n      if (badges.size() > 0) return $(badges[badges.size() - 1]);\n    };\n\n    // getCloestBadge\n    badge.getCloestBadge = function (mouseX, mouseY) {\n      var cloestBadgeEl, isLineMatched;\n      ac.el.children('.' + CLS.badgeCt).each(function () {\n        var badgeEl = $(this), pos = badgeEl.position();\n        var left = pos.left, top = pos.top, bottom = top + badgeEl.outerHeight(),\n          right = pos.left + badgeEl.outerWidth();\n        if (mouseY >= top && mouseY <= bottom) {\n          isLineMatched = true;\n          if (mouseX <= left) {\n            cloestBadgeEl = badgeEl;\n            return false;\n          }\n        } else if (isLineMatched) {// matched last line last badge\n          cloestBadgeEl = badgeEl;\n          return false;\n        }\n      });\n      return cloestBadgeEl;\n    };\n\n    // add\n    badge.add = function (val, speicalData) {\n      var item = ac.panel.getSelectedItem();\n      if (!item) {\n        if (!val) {\n          delete ac.editingItem;\n          return;\n        }\n\n        if (ac.editingItem) {\n          if (val === ac.editingItem.item) item = val;\n          else if (isString(val)) {\n            if (ac.editingItem.text == val) item = ac.editingItem.item;\n          } else {\n            var ei = ac.editingItem.item, eiCode = ei.c || ei.code, eiName = ei.n || ei.name;\n            var valCode = ei.c || ei.code, valName = ei.n || ei.name;\n            if (valCode == eiCode && valName == eiName) item = val;\n          }\n        }\n\n        if (!item) {\n          var findItem;\n          if (isString(val)) {\n            findItem = ac.searchInData(val, speicalData);\n            if (!findItem && !ac.params.forceSelect) item = {c: val, n: val};\n          } else {\n            if (ac.params.forceSelect) {\n              findItem = ac.searchInData(val, speicalData);\n              if (findItem) item = findItem;\n            } else item = val;\n          }\n        }\n\n        if (!item) {\n          delete ac.editingItem;\n          return;\n        }\n      }\n      delete ac.editingItem;\n\n      var badgeEl, itemName = item.n || item.name, customNameHtml = item.hn || item.htmlName;\n      if (ac.params.badgeRender) badgeEl = ac.params.badgeRender.call(ac, item);\n      else {\n        badgeEl = $(ac.params.tpls.badgeTpl);\n        var text = badgeEl.find('.badge-text');\n        if (ac.params.itemUseHtml) text.append(ohtml($(customNameHtml || itemName)));\n        else text.text(itemName);\n        text.attr('title', itemName);\n      }\n\n      badgeEl.addClass(CLS.badgeCt + ' ' + ac.params.badgeCls).click(function (e) {\n        stopEvent(e);\n      });\n\n      // close handler\n      badgeEl.find('.badge-close').click(function (e) {\n        if (ac.isReadonly()) return;\n        badgeEl.remove();\n        ac.removeSelected(item);\n\n        if (ac.selectedItems.length <= 0) ac.input.blur();\n        ac.close();\n        ac.placeholder.refresh();\n        ac.fireBadgeRemoved();\n        stopEvent(e);\n      });\n\n      // text handler\n      badgeEl.find('.badge-text')[ac.params.dblclick4Edit ? 'dblclick' : 'click'](function (e) {\n        if (ac.isReadonly()) return;\n\n        badgeEl.after(ac.input.el).remove();\n        ac.removeSelected(item);\n\n        var text = ac.isInSearchMode('name') ? item.n || item.name : item.c || item.code;\n        if (ac.params.getText4BadgeEdit) text = ac.params.getText4BadgeEdit.call(ac, item, text);\n        ac.editingItem = {item: item, text: text};\n        ac.close();\n        ac.input.updateTextValue(text);\n        stopEvent(e);\n      });\n\n      var doAdd = false;\n      if (ac.params.filtSame && ac.selectedItems.length > 0 && !ac.isSingleMode()) {\n        var hasSame = ac.findSelectedItem(item) >= 0;\n        if (hasSame) return true;\n        else doAdd = true;\n      } else doAdd = true;\n\n      if (doAdd) {\n        if (ac.isSingleMode()) ac.el.children('.' + CLS.badgeCt).remove();\n        ac.input.el.before(badgeEl);\n        ac.addSelected(item, !speicalData);\n        badge.resize(badgeEl);\n        if (ac.isSingleMode()) ac.input.updateTextValue(itemName, false);\n        ac.placeholder.refresh();\n      }\n      return doAdd;\n    };\n\n    if (ac.isSingleMode()) ac.el.addClass('single-badge');\n  };\n\n  // Input\n  var Input = function (ac) {\n    var input = this, inputCt = input.el = $(ac.params.tpls.inputTpl).appendTo(ac.el);\n    var inputSizer = inputCt.children('.input-delegate-sizer');\n\n    var loadTimeout, compositionFlag;\n    var inputEl = inputCt.children(':text');\n\n    var loadDataOnInput = ac.params.debounceFn(ac.params.inputSearchDelay, function () {\n      if (ac.destoried) return;\n\n      if (inputEl.val().length < ac.params.minChar) {\n        ac.close();\n        ac.panel.el.empty();\n        return;\n      }\n\n      ac.loadData({from: 'keydown'}).then(function () {\n        ac.open();\n        ac.panel.render();\n      });\n    }, true);\n\n    inputEl.on({\n      'focus'           : function (e) {\n        if (ac.isReadonly()) {\n          inputEl.blur();\n          stopEvent(e);\n          return;\n        }\n\n        input.isFocused = true;\n        input.updateSizer();\n        ac.placeholder.el.hide();\n        ac.el.addClass('focus');\n        if (ac.params.minChar <= 0 || inputEl.val().length >= ac.params.minChar) ac.openOnFocus();\n        if (ac.isSingleMode() && ac.getValue().length > 0) {\n          setCaretPosition(inputEl[0]);\n          ac.editingItem = {item: ac.getValue()[0], text: inputEl.val()};\n        }\n        ac.fireOnFocus();\n      },\n      'blur'            : function () {\n        if (!input.isFocused) return;\n        input.isFocused = false;\n        ac.el.removeClass('focus');\n\n        if (inputEl.val() && !input.beforeMoveVal || !inputEl.val() && ac.isSingleMode())\n          input.confirmValue(false, true);\n        ac.placeholder.refresh();\n        ac.close();\n        ac.fireOnBlur();\n      },\n      'keydown'         : function (e) {\n        if (ac.isReadonly()) return;\n\n        input.updateSizer();\n\n        var specialKey = false;\n        switch (e.keyCode) {\n          case KEY_CODES.ENTER:\n            var item = ac.panel.getSelectedItem();\n            if (item) {\n              var itemName = item.n || item.name, itemCode = item.c || item.code;\n              if (ac.isInSearchMode('name') && itemName) inputEl.val(itemName);\n              else if (itemCode) inputEl.val(itemCode);\n            }\n            input.blur();\n            stopEvent(e);\n            specialKey = true;\n            break;\n          case KEY_CODES.ESC:\n            input.confirmValue(true);\n            specialKey = true;\n            break;\n          case KEY_CODES.TAB:\n            var hasVal = !!inputEl.val();\n            input.confirmValue();\n            if (hasVal && !ac.isSingleMode()) {\n              inputEl.focus();\n              stopEvent(e);\n            }\n            specialKey = true;\n            break;\n          case KEY_CODES.LEFT:\n          case KEY_CODES.RIGHT:\n            var caretPos = getCaretPosition(inputEl[0]), textLen = inputEl.val().length;\n            if (e.keyCode == KEY_CODES.LEFT && caretPos == 0) {\n              input.moveToLR(true);\n              stopEvent(e);\n            } else if (e.keyCode == KEY_CODES.RIGHT && caretPos == textLen) {\n              input.moveToLR(false);\n              stopEvent(e);\n            }\n            specialKey = true;\n            break;\n          case KEY_CODES.UP:\n          case KEY_CODES.DOWN:\n            ac.panel.moveSelect(e.keyCode == KEY_CODES.UP);\n            stopEvent(e);\n            specialKey = true;\n            break;\n          case KEY_CODES.BACK:\n            if (!inputEl.val()) {\n              var prevBadge = inputCt.prev('.' + CLS.badgeCt);\n              if (prevBadge.size() > 0) {\n                ac.badge.closeBadge(prevBadge);\n                stopEvent(e);\n                specialKey = true;\n              }\n            }\n            break;\n          case KEY_CODES.DELETE:\n            if (!inputEl.val()) {\n              var nextBadge = inputCt.next('.' + CLS.badgeCt);\n              if (nextBadge.size() > 0) {\n                ac.badge.closeBadge(nextBadge);\n                stopEvent(e);\n                specialKey = true;\n              }\n            }\n            break;\n          default:\n            ac.panel.relocate();\n        }\n\n        if (!specialKey) {\n          if (loadTimeout) clearTimeout(loadTimeout);\n          loadTimeout = setTimeout(function () { // 由于是监听keydown事件，而最后实际输入的字符要keyup之后才能拿到，所以设置个延迟\n            loadTimeout = undefined;\n            if (!compositionFlag) loadDataOnInput();\n          }, 200);\n        }\n      },\n      'keyup'           : function (e) {\n        if (ac.isReadonly()) return;\n        input.updateSizer();\n      },\n      'compositionstart': function () {\n        compositionFlag = true;\n        // console.log('输入法，录入开始');\n      },\n      'compositionend'  : function () {\n        compositionFlag = false;\n        loadDataOnInput(); //在input之后执行 所以需要手动调用一次\n        // console.log('输入法，输入结束');\n      },\n    });\n\n    // moveToLR\n    input.moveToLR = function (isLeft) {\n      if (ac.isSingleMode()) return;\n\n      var badge = isLeft ? inputCt.prev('.' + CLS.badgeCt + ' ') : inputCt.next('.' + CLS.badgeCt);\n      if (badge) {\n        input.beforeMoveVal = inputEl.val();\n        isLeft ? badge.before(inputCt) : badge.after(inputCt);\n        inputEl.val(input.beforeMoveVal);\n        input.focus();\n        delete input.beforeMoveVal;\n      }\n    };\n\n    // moveToBadge\n    input.moveToBadge = function (badge) {\n      if (ac.isSingleMode()) return;\n\n      if (badge) badge.before(input.el);\n      else {\n        var lastBadge = ac.badge.getLastBadge();\n        if (lastBadge) lastBadge.after(input.el);\n      }\n    };\n\n    // updateSizer\n    input.updateSizer = function () {\n      inputSizer.text(inputEl.val() + 'WW');\n    };\n\n    // updateTextValue\n    input.updateTextValue = function (text, focus) {\n      inputEl.val(text);\n      if (!input.isFocused && focus !== false) input.focus();\n      input.updateSizer();\n      if (isIE && focus !== false) setCaretPosition(inputEl[0]);\n    };\n\n    // confirmValue\n    input.confirmValue = function (isEsc, fromBlur) {\n      var added;\n\n      if (isEsc) {\n        if (ac.editingItem) added = ac.badge.add(ac.editingItem.item);\n      } else added = ac.badge.add(inputEl.val());\n\n      //if (isIE && ac.isSingleMode() && fromBlur) {\n      //  ac.close();\n      //  return;\n      //}\n\n      if (ac.isSingleMode()) {\n        if (!added) {\n          if (ac.selectedItems.length > 0) ac.removeSelected(ac.selectedItems[0]);\n          if (inputEl.val()) input.clear();\n        }\n        if (!fromBlur) inputEl.blur();\n        ac.close();\n      } else if (inputEl.val()) input.clear();\n    };\n\n    // blur\n    input.blur = function () {\n      if (!input.isFocused) return;\n      inputEl.blur();\n    };\n\n    // clear\n    input.clear = function (fireBlur) {\n      inputEl.val('');\n      if (fireBlur === false) ac.placeholder.refresh();\n      else inputEl.blur();\n      inputSizer.text('W');\n    };\n\n    // getSearchText\n    input.getSearchText = function () {\n      return inputEl.val();\n    };\n\n    // focus\n    input.focus = function () {\n      if (input.isFocused) return;\n      inputEl.focus();\n    };\n\n    inputSizer.text('WW');\n    input.emptyWidth = getOuterWidth(inputCt);\n    inputSizer.text('W');\n  };\n\n  // DropdownPanel\n  var DropdownPanel = function (ac) {\n    var panel = this, panelEl = panel.el = $(ac.params.tpls.dropdownTpl).appendTo(ac.el);\n\n    // moveSelect\n    panel.moveSelect = function (isUp) {\n      var selItem = panelEl.children('li.selected'), moveToItem, itemCls = '.' + CLS.dropdownItem;\n      var skipMultiSel = !ac.isSingleMode() && ac.params.hideOtherSelected4Multiple;\n      if (skipMultiSel) itemCls += ':not(.' + CLS.multiHideSel + ')';\n      if (selItem.size() > 0) {\n        moveToItem = isUp ? selItem.prev() : selItem.next();\n\n        while (moveToItem.size() > 0) {\n          if (moveToItem.hasClass(CLS.dropdownItem) && (!skipMultiSel || !moveToItem.hasClass(CLS.multiHideSel)))\n            break;\n          moveToItem = isUp ? moveToItem.prev() : moveToItem.next();\n        }\n\n        if (moveToItem.size() <= 0) {\n          var items = panelEl.children(itemCls);\n          if (items.size() > 0) moveToItem = isUp ? $(items[items.size() - 1]) : $(items[0]);\n        }\n      } else {\n        var items = panelEl.children(itemCls);\n        if (items.size() > 0) moveToItem = isUp ? $(items[items.size() - 1]) : $(items[0]);\n      }\n\n      if (moveToItem && moveToItem.length > 0) {\n        selItem.removeClass('selected');\n        moveToItem.addClass('selected');\n        panel.scrollToSelected(moveToItem);\n      }\n    };\n\n    // scrollToSelected\n    panel.scrollToSelected = function (selectedItem) {\n      selectedItem = selectedItem || panelEl.children('li.selected');\n      if (selectedItem.size() > 0) {\n        var scrollTop = panelEl.scrollTop(), top = selectedItem.position().top + scrollTop;\n        top = top - (panelEl.height() - selectedItem.height()) / 2;\n        panelEl.scrollTop(top);\n      }\n    };\n\n    // getSelectedItem\n    panel.getSelectedItem = function () {\n      return panelEl.children('li.selected').data('bsAutoCompleteItem');\n    };\n\n    // render\n    panel.render = function () {\n      var data = ac.data || [], searchText = ac.input.getSearchText();\n      panelEl.empty();\n      panelEl.scrollTop();\n\n      var ei = ac.editingItem && ac.editingItem.item || {}, eiCode = ei.c || ei.code, eiName = ei.n || ei.name;\n      if (data.length > 0) {\n        var matched = false, hasOptGroup;\n        var isMultiMode = !ac.isSingleMode(), hideOtherSelected4Multiple = ac.params.hideOtherSelected4Multiple;\n        var lastGroupEl, lastGroupChildCount = 0, selectableItemCount = 0;\n\n        $.each(data, function (i, item) {\n          var itemEl, itemName = item.n || item.name, itemCode = item.c || item.code,\n            customNameHtml = item.hn || item.htmlName, selectable = true;\n          if (ac.params.itemRender) itemEl = ac.params.itemRender.call(ac, item, searchText);\n          else {\n            itemEl = $(ac.params.tpls.dropdownItemTpl);\n            var text = itemEl.find('.text');\n            if (ac.params.itemUseHtml) text.append(ohtml($(customNameHtml || itemName)));\n            else text.text(itemName);\n          }\n\n          if (isMultiMode) {\n            var selectedItem = ac.selectedItemMap[itemCode];\n            if (selectedItem &&\n              (\n                selectedItem === item ||\n                (selectedItem.c || selectedItem.code) === itemCode &&\n                (selectedItem.n || selectedItem.name) === itemName\n              )\n            ) {\n              itemEl.addClass(CLS.multiSelected);\n              if (hideOtherSelected4Multiple) {\n                selectable = false;\n                itemEl.addClass(CLS.multiHideSel);\n              }\n            }\n          }\n\n          if (item.optGroup === true) {\n            selectable = false;\n            itemEl.addClass('bs-autocomplete-group');\n            if (!hasOptGroup) {\n              hasOptGroup = true;\n              panelEl.addClass('bs-autocomplete-grouped');\n            }\n\n            if (lastGroupEl && lastGroupChildCount <= 0)\n              lastGroupEl.addClass('bs-autocomplete-group-hide');\n\n            lastGroupEl = itemEl;\n            lastGroupChildCount = 0;\n          } else {\n            if (lastGroupEl && selectable) lastGroupChildCount++;\n            if (selectable) selectableItemCount++;\n            itemEl.addClass(CLS.dropdownItem);\n          }\n          if (item.cls) itemEl.addClass(item.cls);\n\n          itemEl.data('bsAutoCompleteItem', item).appendTo(panelEl)\n            .attr('title', itemName)\n            .mousedown(function (e) {\n              if (ac.isReadonly()) return;\n              if (item.optGroup) {\n                stopEvent(e);\n                return;\n              }\n\n              if (isIE) ac.input.blur();\n              ac.input.clear();\n              ac.badge.add(item);\n              stopEvent(e);\n            });\n\n          if (!matched && searchText) {\n            if (ac.editingItem && ac.editingItem.text == searchText) {\n              if (eiCode == itemCode && eiName == itemName)\n                matched = true;\n            }\n            if (ac.isInSearchMode('name') && searchText == itemName) {\n              matched = true;\n            } else if (ac.isInSearchMode('code') && searchText == itemCode) {\n              matched = true;\n            }\n            if (matched) itemEl.addClass('selected');\n          }\n        });\n\n        if (lastGroupEl && lastGroupChildCount <= 0)\n          lastGroupEl.addClass('bs-autocomplete-group-hide');\n\n        if (selectableItemCount <= 0) {\n          panelEl.addClass('no-selectable-items');\n        } else {\n          panelEl.removeClass('no-selectable-items');\n        }\n\n      } else ac.close();\n    };\n\n    // resize\n    panel.resize = function () {\n      panelEl.css('max-width', ac.el.width());\n      ac.fireOnPanelResize(ac);\n    };\n\n    // relocate\n    panel.relocate = function () {\n      var inputPosLeft = ac.input.el.position().left;\n      if (ac.isSingleMode()) inputPosLeft = 0;\n      panelEl.css('left', inputPosLeft + 'px');\n    };\n\n    // close\n    panel.close = function () {\n      panelEl.children().removeClass('selected');\n    };\n\n    // destroy\n    panel.destroy = function () {\n      panelEl.children().each(function () {\n        $(this).removeData('bsAutoCompleteItem');\n      });\n      panelEl.remove();\n    };\n  };\n\n  // AutoComplete\n  var AutoComplete = function (params, originEl) {\n    var ac = this;\n    params = $.extend(true, {tpls: TPLS}, params || {});\n    for (var def in DEF_OPTS) if (typeof params[def] === 'undefined') params[def] = DEF_OPTS[def];\n    ac.params = params, ac.initialized = false, ac.selectedItems = [], ac.selectedItemMap = {}, ac.readonly = false;\n\n    // htmlOverHandler\n    var htmlOverHandler = function () {\n      if (!ac.resized4htmlOver) {\n        if (ac.el.is(':visible')) ac.resize();\n        $('html').off('mouseover', htmlOverHandler);\n        ac.resized4htmlOver = true;\n      }\n    };\n\n    // htmlClickHandler\n    var htmlClickHandler = function (e) {\n      if (!ac.el.hasClass('open')) return;\n      if ($(e.target).hasClass('bootstrap-autocomplete')) return;\n\n      var autocomplete = $(e.target).parents('.bootstrap-autocomplete');\n      if (autocomplete.size() == 0) ac.close();\n      else if (autocomplete[0] != ac.el[0]) ac.close();\n    };\n\n    // htmlResizeHandler\n    var resizeTimeout;\n    var htmlResizeHandler = function (e) {\n      if (resizeTimeout) clearTimeout(resizeTimeout);\n      setTimeout(function () {\n        ac.panel.resize();\n      }, 100);\n    };\n\n    // elOverHandler\n    var elOverHandler = function () {\n      if (!ac.resized4elOver) {\n        if (ac.el.is(':visible')) ac.resize();\n        ac.el.off('mouseover', elOverHandler);\n        ac.resized4elOver = true;\n      }\n    };\n\n    // addValue\n    ac.addValue = function (items, opts) {\n      opts = $.extend({onSetFinish: $.noop}, opts || {});\n\n      var oldSelectedItems = ac.getValue(), changeFired;\n      if (opts.clear) ac.clearValue(false);\n      if (!items) {\n        opts.fireInit ? ac.fireOnInit() : changeFired = ac.fireOnChange(oldSelectedItems, ac.getValue());\n        opts.onSetFinish.call(ac, changeFired);\n        return;\n      }\n\n      if (!(items instanceof Array)) {\n        if (isString(items)) items = [{c: items, n: items}];\n        else items = [items];\n      } else if (items.length <= 0) {\n        return;\n      } else {\n        var formatedItems = [];\n        $.each(items, function (i, item) {\n          if (isString(item)) formatedItems.push({c: item, n: item});\n          else formatedItems.push(item);\n        });\n        items = formatedItems;\n      }\n\n      if (ac.params.forceSelect && ac.params.loadDataItems) {\n        ac.loadDataItems(items).then(function (tmpData) {\n          $.each(items, function (i, item) {\n            ac.badge.add(item, tmpData);\n          });\n        }).always(function () {\n          opts.fireInit ? ac.fireOnInit() : changeFired = ac.fireOnChange(oldSelectedItems, ac.getValue());\n          opts.onSetFinish.call(ac, changeFired);\n        });\n      } else {\n        var lastSearchData = ac.data, needCheckRemote = ac.params.forceSelect && ac.params.loadData && true;\n        var toCheckCount = items.length, checkedItemCount = 0;\n        if (items.length > 0 && !needCheckRemote) ac.data = (ac.params.data || []).slice();\n        $.each(items, function (i, item) {\n          if (needCheckRemote) {\n            if (ac.searchInData(item, lastSearchData)) {\n              ac.badge.add(item);\n              checkedItemCount++;\n            } else {\n              var itemCode = item.c || item.code, itemName = item.n || item.name;\n              var searchMode = ac.isInSearchMode('name') ? 'name' : 'code';\n              var searchText = searchMode == 'code' ? itemCode : itemName, tmpData = [];\n              ac.loadData({\n                searchText                : searchText,\n                specialData               : tmpData,\n                showAllItemsWhenFirstFocus: false,\n                searchMode                : searchMode,\n                from                      : 'addValue'\n              }).then(function (tmpData) {\n                lastSearchData = tmpData;\n                ac.badge.add(item, tmpData);\n              }).always(function () {\n                if (++checkedItemCount == toCheckCount) {\n                  opts.fireInit ? ac.fireOnInit() : changeFired = ac.fireOnChange(oldSelectedItems, ac.getValue());\n                  opts.onSetFinish.call(ac, changeFired);\n                }\n              });\n            }\n          } else ac.badge.add(item);\n        });\n        if (!needCheckRemote) {\n          opts.fireInit ? ac.fireOnInit() : changeFired = ac.fireOnChange(oldSelectedItems, ac.getValue());\n          opts.onSetFinish.call(ac, changeFired);\n        }\n      }\n    };\n\n    // setValue\n    ac.setValue = function (items, opts) {\n      opts = $.extend(opts || {}, {clear: true});\n      ac.addValue(items, opts);\n    };\n\n    // openOnFocus\n    ac.openOnFocus = function () {\n      var showAllItemsWhenFirstFocus = ac.params.showAllWhenSingleForceSelectFocus && ac.params.forceSelect && ac.isSingleMode();\n      ac.loadData({showAllItemsWhenFirstFocus: showAllItemsWhenFirstFocus, from: 'openOnFocus'}).then(function () {\n        ac.open();\n        ac.panel.render();\n      });\n    };\n\n    // isInSearchMode\n    ac.isInSearchMode = function (mode) {\n      return ac.params.searchMode.indexOf(mode) >= 0;\n    };\n\n    // resize\n    ac.resize = function () {\n      ac.badge.resize();\n    };\n\n    // destroy\n    ac.destroy = function () {\n      ac.destoried = true;\n      ac.panel.destroy();\n      $('html').off({'click': htmlClickHandler, 'mouseover': htmlOverHandler});\n      $(window).off('resize', htmlResizeHandler);\n      ac.params.el.removeData(\"bsAutoComplete\");\n      ac.el.remove();\n    };\n\n    // fireOnChange\n    ac.fireOnChange = function (oldItems, newItems) {\n      var fire = true;\n      if (oldItems != newItems && oldItems.length == newItems.length) {\n        var allItemsSame = true;\n        $.each(oldItems, function (i, oldItem) {\n          var oldItemCode = oldItem.code || oldItem.c, oldItemName = oldItem.name || oldItem.n;\n          var newItem = newItems[i], newItemCode = newItem.code || newItem.c, newItemName = newItem.name || newItem.n;\n          if (oldItemCode != newItemCode || oldItemName != newItemName) {\n            allItemsSame = false;\n            return false;\n          }\n        });\n        if (allItemsSame) fire = false;\n      }\n      if (fire) {\n        if (ac.params.disableResizeContainer !== false && ac.resizeContainer)\n          setTimeout(function () { ac.containerEl.height(ac.el.outerHeight()); }, 0);\n        ac.params.el.trigger('bs.autocomplete.change', [oldItems, newItems]);\n      }\n      return fire;\n    };\n\n    // fireOnPanelResize\n    ac.fireOnPanelResize = function () {\n      ac.params.el.trigger('bs.autocomplete.panel.resize', [ac]);\n    };\n\n    // fireOnSelect\n    ac.fireOnSelect = function (item, items) {\n      ac.params.el.trigger('bs.autocomplete.select', [item, items]);\n    };\n\n    // fireOnClose\n    ac.fireOnClose = function () {\n      if (ac.inputGroupEl) ac.inputGroupEl.removeClass('open');\n      ac.params.el.trigger('bs.autocomplete.close');\n    };\n\n    // fireOnInit\n    ac.fireOnInit = function () {\n      if (ac.isInitialized) return;\n\n      ac.isInitialized = true;\n      ac.params.el.trigger('bs.autocomplete.inited');\n    };\n\n    // fireOnFocus\n    ac.fireOnFocus = function () {\n      if (ac.inputGroupEl) ac.inputGroupEl.addClass('focus');\n      ac.params.el.trigger('bs.autocomplete.focus');\n    };\n\n    // fireOnPen\n    ac.fireOnPen = function () {\n      if (ac.inputGroupEl) ac.inputGroupEl.addClass('open');\n      ac.params.el.trigger('bs.autocomplete.open');\n    };\n\n    // fireBadgeRemoved\n    ac.fireBadgeRemoved = function () {\n      ac.params.el.trigger('bs.autocomplete.badge.removed');\n    };\n\n    // fireOnBlur\n    ac.fireOnBlur = function () {\n      if (ac.inputGroupEl) ac.inputGroupEl.removeClass('focus');\n      ac.params.el.trigger('bs.autocomplete.blur');\n    };\n\n    // fireOnDeSelect\n    ac.fireOnDeSelect = function (item, items) {\n      ac.params.el.trigger('bs.autocomplete.deselect', [item, items]);\n    };\n\n    // is\n    ac.isSingleMode = function () {\n      return !ac.params.multiple;\n    };\n\n    // close\n    ac.close = function () {\n      ac.el.removeClass('open');\n      ac.panel.close();\n      ac.fireOnClose();\n    };\n\n    // open\n    ac.open = function () {\n      if (ac.readonly) return;\n      ac.panel.resize();\n      ac.panel.relocate();\n      ac.el.addClass('open');\n      ac.fireOnPen();\n    };\n\n    // getValue\n    ac.getValue = function () {\n      return ac.selectedItems.slice();\n    };\n\n    // clearData\n    ac.clearData = function () {\n      ac.data.splice(0, ac.data.length);\n    };\n\n    // clearValue\n    ac.clearValue = function (fire) {\n      if (ac.isSingleMode()) ac.input.clear(fire);\n\n      var oldSelectedItems = ac.getValue();\n      ac.selectedItems.splice(0, ac.selectedItems.length);\n      ac.selectedItemMap = {};\n      ac.el.children('.' + CLS.badgeCt).remove();\n      ac.el.removeClass('selected');\n      ac.placeholder.refresh();\n      if (fire !== false) {\n        ac.params.el.trigger('bs.autocomplete.clear');\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    // setReadonly\n    ac.setReadonly = function (readonly) {\n      readonly = readonly !== false;\n      ac.readonly = readonly;\n      if (readonly) ac.el.addClass('readonly');\n      else ac.el.removeClass('readonly');\n    };\n\n    // isReadonly\n    ac.isReadonly = function () {\n      return ac.readonly;\n    };\n\n    // addSelected\n    ac.addSelected = function (item, fire) {\n      var oldSelectedItems = ac.selectedItems.slice();\n\n      if (ac.isSingleMode()) {\n        ac.selectedItems.splice(0, ac.selectedItems.length);\n        ac.selectedItemMap = {};\n      }\n\n      ac.selectedItems.push(item);\n      ac.selectedItemMap[item.c || item.code] = item;\n      if (ac.selectedItems.length > 0) ac.el.addClass('selected');\n\n      if (fire !== false) {\n        ac.fireOnSelect(item, ac.getValue());\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    // removeSelected\n    ac.removeSelected = function (item) {\n      var findIndex = ac.findSelectedItem(item);\n      if (findIndex >= 0) {\n        var oldSelectedItems = ac.selectedItems.slice();\n        ac.selectedItems.splice(findIndex, 1);\n        delete ac.selectedItemMap[item.c || item.code];\n        if (ac.selectedItems.length <= 0) ac.el.removeClass('selected');\n\n        ac.fireOnDeSelect(item, ac.getValue());\n        ac.fireOnChange(oldSelectedItems, ac.getValue());\n      }\n    };\n\n    // isItemMatched\n    ac.isItemMatched = function (searchText, item) {\n      var regex = new RegExp(escapeRegex(searchText), ac.params.ignoreCase ? 'i' : undefined);\n      var matched = false;\n      if (ac.isInSearchMode('name')) matched = regex.test(item.n || item.name);\n      if (!matched && ac.isInSearchMode('code')) matched = regex.test(item.c || item.code);\n      return matched;\n    };\n\n    // findSelectedItem\n    ac.findSelectedItem = function (item) {\n      var result = -1, itemCode = item.c || item.code, itemName = item.n || item.name;\n      $.each(ac.selectedItems, function (i, selItem) {\n        var selCode = selItem.c || selItem.code, selName = selItem.n || selItem.name;\n        if (selCode == itemCode && selName == itemName) {\n          result = i;\n          return false;\n        }\n      });\n      return result;\n    };\n\n    // searchInData\n    ac.searchInData = function (item, data) {\n      var isFromStr = isString(item);\n      if (isFromStr) item = {c: item, n: item};\n      var findItem, itemCode = item.c || item.code, itemName = item.n || item.name, data = data || ac.data;\n\n      $.each(data, function (i, dataItem) {\n        var dataCode = dataItem.c || dataItem.code, dataName = dataItem.n || dataItem.name;\n        if (isFromStr) {\n          if (ac.isInSearchMode('name') && dataName == itemName || ac.isInSearchMode('code') && dataCode == itemCode) {\n            findItem = dataItem;\n            return false;\n          }\n        } else {\n          if (dataName == itemName && dataCode == itemCode) {\n            findItem = dataItem;\n            return false;\n          }\n        }\n      });\n      return findItem;\n    };\n\n    // loadDataItems\n    ac.loadDataItems = function (items) {\n      var defered = $.Deferred();\n      var loadedItems = [];\n\n      ac.params.loadDataItems.call(ac, items, function (data) {\n        if (data) {\n          $.each(data, function (i, item) {\n            if (isString(item)) item = {c: item, n: item};\n            loadedItems.push(item);\n          });\n          defered.resolve(loadedItems);\n        } else defered.reject();\n      });\n\n      return defered.promise();\n    };\n\n    // loadData\n    ac.loadData = function (opts) {\n      opts = opts || {};\n      opts.searchText = opts.showAllItemsWhenFirstFocus ? '' : (opts.searchText || ac.input.getSearchText());\n      var defered = $.Deferred();\n\n      opts.specialData = opts.specialData || ac.data;\n      opts.specialData.splice(0, opts.specialData.length);\n      if (ac.params.loadData) {\n        ac.params.loadData.call(ac, opts.searchText, function (data) {\n          if (data) {\n            opts.specialData.splice(0, opts.specialData.length);\n            $.each(data, function (i, item) {\n              if (isString(item)) item = {c: item, n: item};\n              opts.specialData.push(item);\n            });\n            defered.resolve(opts.specialData);\n          } else defered.reject();\n        }, opts.searchMode, opts.from);\n      } else {\n        var data = ac.params.data || [], lastGroupItem;\n        $.each(data, function (i, item) {\n          if (isString(item)) item = {c: item, n: item};\n          if (item.optGroup === true) {\n            lastGroupItem = item;\n            return;\n          }\n          if (opts.searchText && !ac.isItemMatched(opts.searchText, item)) return;\n          if (lastGroupItem) {\n            opts.specialData.push(lastGroupItem);\n            lastGroupItem = undefined;\n          }\n          opts.specialData.push(item);\n        });\n        defered.resolve(opts.specialData);\n      }\n      return defered.promise();\n    };\n\n    ac.data = [], ac.el = $(ac.params.tpls.containerTpl).addClass(ac.params.cls);\n\n    // 解决在 input-group 中的样式问题\n    var inputGroupEl = ac.inputGroupEl = params.el.closest('.input-group'),\n      isUnderInputGroup = ac.isUnderInputGroup = inputGroupEl.size() > 0;\n\n    var isOriginInputEl = params.el.is(':input');\n    if (isOriginInputEl && !ac.params.replace) ac.params.replace = true;\n\n    // 原始元素为 input 时且父元素为 input-group 时放入代理容器\n    var inputDelegateCtEl;\n    if (isOriginInputEl && params.el.parent().hasClass('input-group')) {\n      inputDelegateCtEl = ac.inputDelegateCtEl = $(ac.params.tpls.inputDelegateContainerTpl)\n        .addClass('form-control');\n      inputDelegateCtEl.insertAfter(params.el);\n      params.el.appendTo(inputDelegateCtEl);\n    }\n\n    if (ac.params.fitWdith !== false) ac.el.addClass('fit-width');\n    if (ac.params.dropUp) ac.el.addClass('dropup');\n    if (ac.params.replace) {\n      ac.el.insertAfter(params.el);\n      params.el.hide();\n    } else {\n      if (inputDelegateCtEl) {\n        ac.el.appendTo(inputDelegateCtEl);\n      } else {\n        if (isUnderInputGroup) params.el.addClass('form-control');\n        ac.el.appendTo(params.el);\n      }\n    }\n\n    var bsAcCtEl = ac.containerEl = ac.el.parent(), resizeHeightCls = 'bs-ac-ct-resize';\n    if (isUnderInputGroup && bsAcCtEl.hasClass('form-control')) bsAcCtEl.addClass(resizeHeightCls);\n    ac.resizeContainer = bsAcCtEl.hasClass(resizeHeightCls);\n\n    ac.input = new Input(ac);\n    ac.panel = new DropdownPanel(ac);\n    ac.badge = new Badge(ac);\n    ac.placeholder = new PlaceHolder(ac);\n    if (ac.params.data) {\n      $.each(ac.params.data, function (i, item) {\n        if (isString(item)) ac.data.push({c: item, n: item});\n        else ac.data.push(item);\n      });\n      ac.params.data = ac.data.slice();\n    }\n\n    { // clear btn\n      $(ac.params.tpls.clearBtnTpl).appendTo(ac.el).click(function (e) {\n        if (ac.isReadonly()) return;\n\n        ac.clearValue();\n        stopEvent(e);\n      });\n    }\n\n    if (ac.params.readonly) ac.setReadonly(true);\n\n    ac.el.on({\n      mousedown: function (e) {\n        if (ac.isReadonly()) return;\n\n        if (e.target == ac.el[0]) {\n          var badge = ac.badge.getCloestBadge(e.offsetX, e.offsetY);\n          ac.input.moveToBadge(badge);\n          if (ac.input.isFocused) stopEvent(e);\n          //ac.input.focus();\n        }\n      },\n      click    : function (e) {\n        if (ac.isReadonly()) return;\n        ac.input.focus();\n        if (ac.input.isFocused) stopEvent(e);\n      },\n      mouseover: elOverHandler\n    });\n\n    originEl.data(\"bsAutoComplete\", this);\n    if (ac.params.value) ac.setValue(ac.params.value, {fireInit: true});\n    else ac.fireOnInit();\n\n    $('html').on({'click': htmlClickHandler, 'mouseover': htmlOverHandler});\n    $(window).on('resize', htmlResizeHandler);\n  };\n\n  $.fn.bsAutoComplete = function (params) {\n    var args = arguments;\n    return this.each(function () {\n      if (!this) return;\n      var $this = $(this);\n\n      var bsAutoComplete = $this.data(\"bsAutoComplete\");\n      if (!bsAutoComplete && params != 'destroy') {\n        params = $.extend({\n          el: $this, value: $this.val() ? $this.val().split(params.splitChar || ' ') : ''\n        }, params);\n        bsAutoComplete = new AutoComplete(params, $this);\n      }\n      if (bsAutoComplete && isString(params))\n        bsAutoComplete[params].apply(bsAutoComplete, Array.prototype.slice.call(args, 1));\n    });\n  }\n\n})(jQuery);\n"]}